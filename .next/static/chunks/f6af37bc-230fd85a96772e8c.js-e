"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{6560:function(a,b,c){c.d(b,{"$r":function(){return aD},Bv:function(){return bk},HI:function(){return al},Ie:function(){return bd},JZ:function(){return bh},Rv:function(){return be},Rw:function(){return i.R},TI:function(){return M},UX:function(){return aI},VL:function(){return u},Y9:function(){return bb},ZM:function(){return aF},ZX:function(){return V},"a$":function(){return bc},bO:function(){return ac},e6:function(){return a9},ex:function(){return aE},kP:function(){return ba},lW:function(){return Q},nw:function(){return i.n},oo:function(){return Z},qm:function(){return s},ud:function(){return X},wn:function(){return aG},xE:function(){return L}});var d,e,f=c(8542),g=c(1048),h=c(9618),i=c(2044),j=c(7099),k=c(5150),l=c(5623);/*!
 * @pixi/core - v6.5.1
 * Compiled Sun, 24 Jul 2022 20:56:21 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */ f.Xd.PREFER_ENV=h.isMobile.any?g.Vi.WEBGL:g.Vi.WEBGL2,f.Xd.STRICT_TEXTURE_CACHE=!1;var m=[];function n(a,b){if(!a)return null;var c="";if("string"==typeof a){var d=/\.(\w{3,4})(?:$|\?|#)/i.exec(a);d&&(c=d[1].toLowerCase())}for(var e=m.length-1;e>=0;--e){var f=m[e];if(f.test&&f.test(a,c))return new f(a,b)}throw Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */ var o=function(a,b){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)};function p(a,b){function c(){this.constructor=a}o(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}var q=function(){return(q=Object.assign||function(a){for(var b,c=arguments,d=1,e=arguments.length;d<e;d++)for(var f in b=c[d])Object.prototype.hasOwnProperty.call(b,f)&&(a[f]=b[f]);return a}).apply(this,arguments)},r=function(){function a(a,b){void 0===a&&(a=0),void 0===b&&(b=0),this._width=a,this._height=b,this.destroyed=!1,this.internal=!1,this.onResize=new j.R("setRealSize"),this.onUpdate=new j.R("update"),this.onError=new j.R("onError")}return a.prototype.bind=function(a){this.onResize.add(a),this.onUpdate.add(a),this.onError.add(a),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},a.prototype.unbind=function(a){this.onResize.remove(a),this.onUpdate.remove(a),this.onError.remove(a)},a.prototype.resize=function(a,b){(a!==this._width||b!==this._height)&&(this._width=a,this._height=b,this.onResize.emit(a,b))},Object.defineProperty(a.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),a.prototype.update=function(){this.destroyed||this.onUpdate.emit()},a.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),a.prototype.style=function(a,b,c){return!1},a.prototype.dispose=function(){},a.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},a.test=function(a,b){return!1},a}(),s=function(a){function b(b,c){var d=this,e=c||{},f=e.width,g=e.height;if(!f||!g)throw Error("BufferResource width or height invalid");return(d=a.call(this,f,g)||this).data=b,d}return p(b,a),b.prototype.upload=function(a,b,c){var d=a.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.alphaMode===g.iw.UNPACK);var e=b.realWidth,f=b.realHeight;return c.width===e&&c.height===f?d.texSubImage2D(b.target,0,0,0,e,f,b.format,c.type,this.data):(c.width=e,c.height=f,d.texImage2D(b.target,0,c.internalFormat,e,f,0,b.format,c.type,this.data)),!0},b.prototype.dispose=function(){this.data=null},b.test=function(a){return a instanceof Float32Array||a instanceof Uint8Array||a instanceof Uint32Array},b}(r),t={scaleMode:g.aH.NEAREST,format:g.I2.RGBA,alphaMode:g.iw.NPM},u=function(a){function b(b,c){void 0===b&&(b=null),void 0===c&&(c=null);var d=a.call(this)||this,e=(c=c||{}).alphaMode,i=c.mipmap,j=c.anisotropicLevel,k=c.scaleMode,l=c.width,m=c.height,o=c.wrapMode,p=c.format,q=c.type,s=c.target,t=c.resolution,u=c.resourceOptions;return!b||b instanceof r||((b=n(b,u)).internal=!0),d.resolution=t||f.Xd.RESOLUTION,d.width=Math.round((l||0)*d.resolution)/d.resolution,d.height=Math.round((m||0)*d.resolution)/d.resolution,d._mipmap=void 0!==i?i:f.Xd.MIPMAP_TEXTURES,d.anisotropicLevel=void 0!==j?j:f.Xd.ANISOTROPIC_LEVEL,d._wrapMode=o||f.Xd.WRAP_MODE,d._scaleMode=void 0!==k?k:f.Xd.SCALE_MODE,d.format=p||g.I2.RGBA,d.type=q||g.vK.UNSIGNED_BYTE,d.target=s||g.sp.TEXTURE_2D,d.alphaMode=void 0!==e?e:g.iw.UNPACK,d.uid=(0,h.uid)(),d.touched=0,d.isPowerOfTwo=!1,d._refreshPOT(),d._glTextures={},d.dirtyId=0,d.dirtyStyleId=0,d.cacheId=null,d.valid=l>0&&m>0,d.textureCacheIds=[],d.destroyed=!1,d.resource=null,d._batchEnabled=0,d._batchLocation=0,d.parentTextureArray=null,d.setResource(b),d}return p(b,a),Object.defineProperty(b.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"mipmap",{get:function(){return this._mipmap},set:function(a){this._mipmap!==a&&(this._mipmap=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(a){this._scaleMode!==a&&(this._scaleMode=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(a){this._wrapMode!==a&&(this._wrapMode=a,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),b.prototype.setStyle=function(a,b){var c;return void 0!==a&&a!==this.scaleMode&&(this.scaleMode=a,c=!0),void 0!==b&&b!==this.mipmap&&(this.mipmap=b,c=!0),c&&this.dirtyStyleId++,this},b.prototype.setSize=function(a,b,c){return c=c||this.resolution,this.setRealSize(a*c,b*c,c)},b.prototype.setRealSize=function(a,b,c){return this.resolution=c||this.resolution,this.width=Math.round(a)/this.resolution,this.height=Math.round(b)/this.resolution,this._refreshPOT(),this.update(),this},b.prototype._refreshPOT=function(){this.isPowerOfTwo=(0,h.isPow2)(this.realWidth)&&(0,h.isPow2)(this.realHeight)},b.prototype.setResolution=function(a){var b=this.resolution;return b===a||(this.resolution=a,this.valid&&(this.width=Math.round(this.width*b)/a,this.height=Math.round(this.height*b)/a,this.emit("update",this)),this._refreshPOT()),this},b.prototype.setResource=function(a){if(this.resource===a)return this;if(this.resource)throw Error("Resource can be set only once");return a.bind(this),this.resource=a,this},b.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},b.prototype.onError=function(a){this.emit("error",this,a)},b.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete h.BaseTextureCache[this.cacheId],delete h.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),b.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},b.prototype.dispose=function(){this.emit("dispose",this)},b.prototype.castToBaseTexture=function(){return this},b.from=function(a,c,d){void 0===d&&(d=f.Xd.STRICT_TEXTURE_CACHE);var e="string"==typeof a,g=null;if(e)g=a;else{if(!a._pixiId){var i=c&&c.pixiIdPrefix||"pixiid";a._pixiId=i+"_"+(0,h.uid)()}g=a._pixiId}var j=h.BaseTextureCache[g];if(e&&d&&!j)throw Error('The cacheId "'+g+'" does not exist in BaseTextureCache.');return j||((j=new b(a,c)).cacheId=g,b.addToCache(j,g)),j},b.fromBuffer=function(a,c,d,e){a=a||new Float32Array(c*d*4);var f=new s(a,{width:c,height:d}),h=a instanceof Float32Array?g.vK.FLOAT:g.vK.UNSIGNED_BYTE;return new b(f,Object.assign(t,e||{width:c,height:d,type:h}))},b.addToCache=function(a,b){b&&(-1===a.textureCacheIds.indexOf(b)&&a.textureCacheIds.push(b),h.BaseTextureCache[b]&&console.warn("BaseTexture added to the cache with an id ["+b+"] that already had an entry"),h.BaseTextureCache[b]=a)},b.removeFromCache=function(a){if("string"==typeof a){var b=h.BaseTextureCache[a];if(b){var c=b.textureCacheIds.indexOf(a);return c> -1&&b.textureCacheIds.splice(c,1),delete h.BaseTextureCache[a],b}}else if(a&&a.textureCacheIds){for(var d=0;d<a.textureCacheIds.length;++d)delete h.BaseTextureCache[a.textureCacheIds[d]];return a.textureCacheIds.length=0,a}return null},b._globalBatch=0,b}(h.EventEmitter),v=function(a){function b(b,c){var d=this,e=c||{},f=e.width,g=e.height;(d=a.call(this,f,g)||this).items=[],d.itemDirtyIds=[];for(var h=0;h<b;h++){var i=new u;d.items.push(i),d.itemDirtyIds.push(-2)}return d.length=b,d._load=null,d.baseTexture=null,d}return p(b,a),b.prototype.initFromArray=function(a,b){for(var c=0;c<this.length;c++)a[c]&&(a[c].castToBaseTexture?this.addBaseTextureAt(a[c].castToBaseTexture(),c):a[c]instanceof r?this.addResourceAt(a[c],c):this.addResourceAt(n(a[c],b),c))},b.prototype.dispose=function(){for(var a=0,b=this.length;a<b;a++)this.items[a].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},b.prototype.addResourceAt=function(a,b){if(!this.items[b])throw Error("Index "+b+" is out of bounds");return a.valid&&!this.valid&&this.resize(a.width,a.height),this.items[b].setResource(a),this},b.prototype.bind=function(b){if(null!==this.baseTexture)throw Error("Only one base texture per TextureArray is allowed");a.prototype.bind.call(this,b);for(var c=0;c<this.length;c++)this.items[c].parentTextureArray=b,this.items[c].on("update",b.update,b)},b.prototype.unbind=function(b){a.prototype.unbind.call(this,b);for(var c=0;c<this.length;c++)this.items[c].parentTextureArray=null,this.items[c].off("update",b.update,b)},b.prototype.load=function(){var a=this;if(this._load)return this._load;var b=this.items.map(function(a){return a.resource}).filter(function(a){return a}).map(function(a){return a.load()});return this._load=Promise.all(b).then(function(){var b=a.items[0],c=b.realWidth,d=b.realHeight;return a.resize(c,d),Promise.resolve(a)}),this._load},b}(r),w=function(a){function b(b,c){var d,e,f=this,g=c||{},h=g.width,i=g.height;return Array.isArray(b)?(d=b,e=b.length):e=b,f=a.call(this,e,{width:h,height:i})||this,d&&f.initFromArray(d,c),f}return p(b,a),b.prototype.addBaseTextureAt=function(a,b){if(a.resource)this.addResourceAt(a.resource,b);else throw Error("ArrayResource does not support RenderTexture");return this},b.prototype.bind=function(b){a.prototype.bind.call(this,b),b.target=g.sp.TEXTURE_2D_ARRAY},b.prototype.upload=function(a,b,c){var d=this.length,e=this.itemDirtyIds,f=this.items,g=a.gl;c.dirtyId<0&&g.texImage3D(g.TEXTURE_2D_ARRAY,0,c.internalFormat,this._width,this._height,d,0,b.format,c.type,null);for(var h=0;h<d;h++){var i=f[h];e[h]<i.dirtyId&&(e[h]=i.dirtyId,i.valid&&g.texSubImage3D(g.TEXTURE_2D_ARRAY,0,0,0,h,i.resource.width,i.resource.height,1,b.format,c.type,i.resource.source))}return!0},b}(v),x=function(a){function b(b){var c=this,d=b,e=d.naturalWidth||d.videoWidth||d.width,f=d.naturalHeight||d.videoHeight||d.height;return(c=a.call(this,e,f)||this).source=b,c.noSubImage=!1,c}return p(b,a),b.crossOrigin=function(a,b,c){void 0===c&&0!==b.indexOf("data:")?a.crossOrigin=(0,h.determineCrossOrigin)(b):!1!==c&&(a.crossOrigin="string"==typeof c?c:"anonymous")},b.prototype.upload=function(a,b,c,d){var e=a.gl,f=b.realWidth,h=b.realHeight;if((d=d||this.source)instanceof HTMLImageElement){if(!d.complete||0===d.naturalWidth)return!1}else if(d instanceof HTMLVideoElement&&d.readyState<=1)return!1;return e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.alphaMode===g.iw.UNPACK),this.noSubImage||b.target!==e.TEXTURE_2D||c.width!==f||c.height!==h?(c.width=f,c.height=h,e.texImage2D(b.target,0,c.internalFormat,b.format,c.type,d)):e.texSubImage2D(e.TEXTURE_2D,0,0,0,b.format,c.type,d),!0},b.prototype.update=function(){if(!this.destroyed){var b=this.source,c=b.naturalWidth||b.videoWidth||b.width,d=b.naturalHeight||b.videoHeight||b.height;this.resize(c,d),a.prototype.update.call(this)}},b.prototype.dispose=function(){this.source=null},b}(r),y=function(a){function b(b){return a.call(this,b)||this}return p(b,a),b.test=function(a){var b=globalThis.OffscreenCanvas;return!!b&&a instanceof b||globalThis.HTMLCanvasElement&&a instanceof HTMLCanvasElement},b}(x),z=function(a){function b(c,d){var e=this,f=d||{},h=f.width,i=f.height,j=f.autoLoad,k=f.linkBaseTexture;if(c&&c.length!==b.SIDES)throw Error("Invalid length. Got "+c.length+", expected 6");e=a.call(this,6,{width:h,height:i})||this;for(var l=0;l<b.SIDES;l++)e.items[l].target=g.sp.TEXTURE_CUBE_MAP_POSITIVE_X+l;return e.linkBaseTexture=!1!==k,c&&e.initFromArray(c,d),!1!==j&&e.load(),e}return p(b,a),b.prototype.bind=function(b){a.prototype.bind.call(this,b),b.target=g.sp.TEXTURE_CUBE_MAP},b.prototype.addBaseTextureAt=function(a,b,c){if(!this.items[b])throw Error("Index "+b+" is out of bounds");if(!this.linkBaseTexture||a.parentTextureArray||Object.keys(a._glTextures).length>0){if(a.resource)this.addResourceAt(a.resource,b);else throw Error("CubeResource does not support copying of renderTexture.")}else a.target=g.sp.TEXTURE_CUBE_MAP_POSITIVE_X+b,a.parentTextureArray=this.baseTexture,this.items[b]=a;return a.valid&&!this.valid&&this.resize(a.realWidth,a.realHeight),this.items[b]=a,this},b.prototype.upload=function(a,c,d){for(var e=this.itemDirtyIds,f=0;f<b.SIDES;f++){var g=this.items[f];(e[f]<g.dirtyId||d.dirtyId<c.dirtyId)&&(g.valid&&g.resource?(g.resource.upload(a,g,d),e[f]=g.dirtyId):e[f]< -1&&(a.gl.texImage2D(g.target,0,d.internalFormat,c.realWidth,c.realHeight,0,c.format,d.type,null),e[f]=-1))}return!0},b.test=function(a){return Array.isArray(a)&&a.length===b.SIDES},b.SIDES=6,b}(v),A=function(a){function b(b,c){var d=this;if(c=c||{},!(b instanceof HTMLImageElement)){var e=new Image;x.crossOrigin(e,b,c.crossorigin),e.src=b,b=e}return d=a.call(this,b)||this,!b.complete&&d._width&&d._height&&(d._width=0,d._height=0),d.url=b.src,d._process=null,d.preserveBitmap=!1,d.createBitmap=(void 0!==c.createBitmap?c.createBitmap:f.Xd.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,d.alphaMode="number"==typeof c.alphaMode?c.alphaMode:null,d.bitmap=null,d._load=null,!1!==c.autoLoad&&d.load(),d}return p(b,a),b.prototype.load=function(a){var b=this;return this._load||(void 0!==a&&(this.createBitmap=a),this._load=new Promise(function(a,c){var d=b.source;b.url=d.src;var e=function(){!b.destroyed&&(d.onload=null,d.onerror=null,b.resize(d.width,d.height),b._load=null,b.createBitmap?a(b.process()):a(b))};d.complete&&d.src?e():(d.onload=e,d.onerror=function(a){c(a),b.onError.emit(a)})})),this._load},b.prototype.process=function(){var a=this,b=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var c=globalThis.createImageBitmap,d=!b.crossOrigin||"anonymous"===b.crossOrigin;return this._process=fetch(b.src,{mode:d?"cors":"no-cors"}).then(function(a){return a.blob()}).then(function(d){return c(d,0,0,b.width,b.height,{premultiplyAlpha:a.alphaMode===g.iw.UNPACK?"premultiply":"none"})}).then(function(b){return a.destroyed?Promise.reject():(a.bitmap=b,a.update(),a._process=null,Promise.resolve(a))}),this._process},b.prototype.upload=function(b,c,d){if("number"==typeof this.alphaMode&&(c.alphaMode=this.alphaMode),!this.createBitmap)return a.prototype.upload.call(this,b,c,d);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(a.prototype.upload.call(this,b,c,d,this.bitmap),!this.preserveBitmap){var e=!0,f=c._glTextures;for(var g in f){var h=f[g];if(h!==d&&h.dirtyId!==c.dirtyId){e=!1;break}}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},b.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,a.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},b.test=function(a){return"string"==typeof a||a instanceof HTMLImageElement},b}(x),B=function(a){function b(b,c){var d=this;return c=c||{},(d=a.call(this,document.createElement("canvas"))||this)._width=0,d._height=0,d.svg=b,d.scale=c.scale||1,d._overrideWidth=c.width,d._overrideHeight=c.height,d._resolve=null,d._crossorigin=c.crossorigin,d._load=null,!1!==c.autoLoad&&d.load(),d}return p(b,a),b.prototype.load=function(){var a=this;return this._load||(this._load=new Promise(function(c){if(a._resolve=function(){a.resize(a.source.width,a.source.height),c(a)},b.SVG_XML.test(a.svg.trim())){if(!btoa)throw Error("Your browser doesn't support base64 conversions.");a.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(a.svg)))}a._loadSvg()})),this._load},b.prototype._loadSvg=function(){var a=this,b=new Image;x.crossOrigin(b,this.svg,this._crossorigin),b.src=this.svg,b.onerror=function(c){a._resolve&&(b.onerror=null,a.onError.emit(c))},b.onload=function(){if(a._resolve){var c=b.width,d=b.height;if(!c||!d)throw Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var e=c*a.scale,f=d*a.scale;(a._overrideWidth||a._overrideHeight)&&(e=a._overrideWidth||a._overrideHeight/d*c,f=a._overrideHeight||a._overrideWidth/c*d),e=Math.round(e),f=Math.round(f);var g=a.source;g.width=e,g.height=f,g._pixiId="canvas_"+(0,h.uid)(),g.getContext("2d").drawImage(b,0,0,c,d,0,0,e,f),a._resolve(),a._resolve=null}}},b.getSize=function(a){var c=b.SVG_SIZE.exec(a),d={};return c&&(d[c[1]]=Math.round(parseFloat(c[3])),d[c[5]]=Math.round(parseFloat(c[7]))),d},b.prototype.dispose=function(){a.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},b.test=function(a,c){return"svg"===c||"string"==typeof a&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(a)||"string"==typeof a&&b.SVG_XML.test(a)},b.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,b.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,b}(x),C=function(a){function b(c,d){var e=this;if(d=d||{},!(c instanceof HTMLVideoElement)){var f=document.createElement("video");f.setAttribute("preload","auto"),f.setAttribute("webkit-playsinline",""),f.setAttribute("playsinline",""),"string"==typeof c&&(c=[c]);var g=c[0].src||c[0];x.crossOrigin(f,g,d.crossorigin);for(var h=0;h<c.length;++h){var i=document.createElement("source"),j=c[h],k=j.src,l=j.mime,m=(k=k||c[h]).split("?").shift().toLowerCase(),n=m.slice(m.lastIndexOf(".")+1);l=l||b.MIME_TYPES[n]||"video/"+n,i.src=k,i.type=l,f.appendChild(i)}c=f}return(e=a.call(this,c)||this).noSubImage=!0,e._autoUpdate=!0,e._isConnectedToTicker=!1,e._updateFPS=d.updateFPS||0,e._msToNextUpdate=0,e.autoPlay=!1!==d.autoPlay,e._load=null,e._resolve=null,e._onCanPlay=e._onCanPlay.bind(e),e._onError=e._onError.bind(e),!1!==d.autoLoad&&e.load(),e}return p(b,a),b.prototype.update=function(b){if(!this.destroyed){var c=k.vB.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-c),(!this._updateFPS||this._msToNextUpdate<=0)&&(a.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},b.prototype.load=function(){var a=this;if(this._load)return this._load;var b=this.source;return(b.readyState===b.HAVE_ENOUGH_DATA||b.readyState===b.HAVE_FUTURE_DATA)&&b.width&&b.height&&(b.complete=!0),b.addEventListener("play",this._onPlayStart.bind(this)),b.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(b.addEventListener("canplay",this._onCanPlay),b.addEventListener("canplaythrough",this._onCanPlay),b.addEventListener("error",this._onError,!0)),this._load=new Promise(function(c){a.valid?c(a):(a._resolve=c,b.load())}),this._load},b.prototype._onError=function(a){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(a)},b.prototype._isSourcePlaying=function(){var a=this.source;return a.currentTime>0&& !1===a.paused&& !1===a.ended&&a.readyState>2},b.prototype._isSourceReady=function(){var a=this.source;return 3===a.readyState||4===a.readyState},b.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(k.vB.shared.add(this.update,this),this._isConnectedToTicker=!0)},b.prototype._onPlayStop=function(){this._isConnectedToTicker&&(k.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1)},b.prototype._onCanPlay=function(){var a=this.source;a.removeEventListener("canplay",this._onCanPlay),a.removeEventListener("canplaythrough",this._onCanPlay);var b=this.valid;this.resize(a.videoWidth,a.videoHeight),!b&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&a.play()},b.prototype.dispose=function(){this._isConnectedToTicker&&(k.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1);var b=this.source;b&&(b.removeEventListener("error",this._onError,!0),b.pause(),b.src="",b.load()),a.prototype.dispose.call(this)},Object.defineProperty(b.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(a){a!==this._autoUpdate&&(this._autoUpdate=a,!this._autoUpdate&&this._isConnectedToTicker?(k.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(k.vB.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(a){a!==this._updateFPS&&(this._updateFPS=a)},enumerable:!1,configurable:!0}),b.test=function(a,c){return globalThis.HTMLVideoElement&&a instanceof HTMLVideoElement||b.TYPES.indexOf(c)> -1},b.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],b.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},b}(x),D=function(a){function b(b){return a.call(this,b)||this}return p(b,a),b.test=function(a){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap},b}(x);m.push(A,D,y,C,B,s,z,w);var E={__proto__:null,Resource:r,BaseImageResource:x,INSTALLED:m,autoDetectResource:n,AbstractMultiResource:v,ArrayResource:w,BufferResource:s,CanvasResource:y,CubeResource:z,ImageResource:A,SVGResource:B,VideoResource:C,ImageBitmapResource:D},F=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return p(b,a),b.prototype.upload=function(a,b,c){var d=a.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.alphaMode===g.iw.UNPACK);var e=b.realWidth,f=b.realHeight;return c.width===e&&c.height===f?d.texSubImage2D(b.target,0,0,0,e,f,b.format,c.type,this.data):(c.width=e,c.height=f,d.texImage2D(b.target,0,c.internalFormat,e,f,0,b.format,c.type,this.data)),!0},b}(s),G=function(){function a(a,b){this.width=Math.round(a||100),this.height=Math.round(b||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new j.R("disposeFramebuffer"),this.multisample=g.G5.NONE}return Object.defineProperty(a.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),a.prototype.addColorTexture=function(a,b){return void 0===a&&(a=0),this.colorTextures[a]=b||new u(null,{scaleMode:g.aH.NEAREST,resolution:1,mipmap:g.WB.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},a.prototype.addDepthTexture=function(a){return this.depthTexture=a||new u(new F(null,{width:this.width,height:this.height}),{scaleMode:g.aH.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:g.WB.OFF,format:g.I2.DEPTH_COMPONENT,type:g.vK.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},a.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},a.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},a.prototype.resize=function(a,b){if(a=Math.round(a),b=Math.round(b),a!==this.width||b!==this.height){this.width=a,this.height=b,this.dirtyId++,this.dirtySize++;for(var c=0;c<this.colorTextures.length;c++){var d=this.colorTextures[c],e=d.resolution;d.setSize(a/e,b/e)}if(this.depthTexture){var e=this.depthTexture.resolution;this.depthTexture.setSize(a/e,b/e)}}},a.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},a.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},a}(),H=function(a){function b(b){void 0===b&&(b={});var c=this;if("number"==typeof b){var d=arguments[0],e=arguments[1],f=arguments[2],h=arguments[3];b={width:d,height:e,scaleMode:f,resolution:h}}return b.width=b.width||100,b.height=b.height||100,b.multisample=void 0!==b.multisample?b.multisample:g.G5.NONE,(c=a.call(this,null,b)||this).mipmap=g.WB.OFF,c.valid=!0,c.clearColor=[0,0,0,0],c.framebuffer=new G(c.realWidth,c.realHeight).addColorTexture(0,c),c.framebuffer.multisample=b.multisample,c.maskStack=[],c.filterStack=[{}],c}return p(b,a),b.prototype.resize=function(a,b){this.framebuffer.resize(a*this.resolution,b*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},b.prototype.dispose=function(){this.framebuffer.dispose(),a.prototype.dispose.call(this)},b.prototype.destroy=function(){a.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},b}(u),I=function(){function a(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return a.prototype.set=function(a,b,c){var d=b.width,e=b.height;if(c){var f=a.width/2/d,g=a.height/2/e,h=a.x/d+f,i=a.y/e+g;c=l.Lv.add(c,l.Lv.NW),this.x0=h+f*l.Lv.uX(c),this.y0=i+g*l.Lv.uY(c),c=l.Lv.add(c,2),this.x1=h+f*l.Lv.uX(c),this.y1=i+g*l.Lv.uY(c),c=l.Lv.add(c,2),this.x2=h+f*l.Lv.uX(c),this.y2=i+g*l.Lv.uY(c),c=l.Lv.add(c,2),this.x3=h+f*l.Lv.uX(c),this.y3=i+g*l.Lv.uY(c)}else this.x0=a.x/d,this.y0=a.y/e,this.x1=(a.x+a.width)/d,this.y1=a.y/e,this.x2=(a.x+a.width)/d,this.y2=(a.y+a.height)/e,this.x3=a.x/d,this.y3=(a.y+a.height)/e;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},a.prototype.toString=function(){return"[@pixi/core:TextureUvs "+("x0="+this.x0+" y0=")+this.y0+" "+("x1="+this.x1+" y1="+this.y1+" x2=")+this.x2+" "+("y2="+this.y2+" x3="+this.x3)+" y3="+this.y3+"]"},a}(),J=new I;function K(a){a.destroy=function(){},a.on=function(){},a.once=function(){},a.emit=function(){}}var L=function(a){function b(c,d,e,f,g,h){var i=a.call(this)||this;if(i.noFrame=!1,d||(i.noFrame=!0,d=new l.Ae(0,0,1,1)),c instanceof b&&(c=c.baseTexture),i.baseTexture=c,i._frame=d,i.trim=f,i.valid=!1,i._uvs=J,i.uvMatrix=null,i.orig=e||d,i._rotate=Number(g||0),!0===g)i._rotate=2;else if(i._rotate%2!=0)throw Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return i.defaultAnchor=h?new l.E9(h.x,h.y):new l.E9(0,0),i._updateID=0,i.textureCacheIds=[],c.valid?i.noFrame?c.valid&&i.onBaseTextureUpdated(c):i.frame=d:c.once("loaded",i.onBaseTextureUpdated,i),i.noFrame&&c.on("update",i.onBaseTextureUpdated,i),i}return p(b,a),b.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},b.prototype.onBaseTextureUpdated=function(a){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=a.width,this._frame.height=a.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},b.prototype.destroy=function(a){if(this.baseTexture){if(a){var c=this.baseTexture.resource;c&&c.url&&h.TextureCache[c.url]&&b.removeFromCache(c.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,b.removeFromCache(this),this.textureCacheIds=null},b.prototype.clone=function(){var a=this._frame.clone(),c=this._frame===this.orig?a:this.orig.clone(),d=new b(this.baseTexture,!this.noFrame&&a,c,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(d._frame=a),d},b.prototype.updateUvs=function(){this._uvs===J&&(this._uvs=new I),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},b.from=function(a,c,d){void 0===c&&(c={}),void 0===d&&(d=f.Xd.STRICT_TEXTURE_CACHE);var e="string"==typeof a,g=null;if(e)g=a;else if(a instanceof u){if(!a.cacheId){var i=c&&c.pixiIdPrefix||"pixiid";a.cacheId=i+"-"+(0,h.uid)(),u.addToCache(a,a.cacheId)}g=a.cacheId}else{if(!a._pixiId){var i=c&&c.pixiIdPrefix||"pixiid";a._pixiId=i+"_"+(0,h.uid)()}g=a._pixiId}var j=h.TextureCache[g];if(e&&d&&!j)throw Error('The cacheId "'+g+'" does not exist in TextureCache.');return j||a instanceof u?!j&&a instanceof u&&(j=new b(a),b.addToCache(j,g)):(c.resolution||(c.resolution=(0,h.getResolutionOfUrl)(a)),(j=new b(new u(a,c))).baseTexture.cacheId=g,u.addToCache(j.baseTexture,g),b.addToCache(j,g)),j},b.fromURL=function(a,c){var d=Object.assign({autoLoad:!1},null==c?void 0:c.resourceOptions),e=b.from(a,Object.assign({resourceOptions:d},c),!1),f=e.baseTexture.resource;return e.baseTexture.valid?Promise.resolve(e):f.load().then(function(){return Promise.resolve(e)})},b.fromBuffer=function(a,c,d,e){return new b(u.fromBuffer(a,c,d,e))},b.fromLoader=function(a,c,d,e){var g=new u(a,Object.assign({scaleMode:f.Xd.SCALE_MODE,resolution:(0,h.getResolutionOfUrl)(c)},e)),i=g.resource;i instanceof A&&(i.url=c);var j=new b(g);return(d||(d=c),u.addToCache(j.baseTexture,d),b.addToCache(j,d),d!==c&&(u.addToCache(j.baseTexture,c),b.addToCache(j,c)),j.baseTexture.valid)?Promise.resolve(j):new Promise(function(a){j.baseTexture.once("loaded",function(){return a(j)})})},b.addToCache=function(a,b){b&&(-1===a.textureCacheIds.indexOf(b)&&a.textureCacheIds.push(b),h.TextureCache[b]&&console.warn("Texture added to the cache with an id ["+b+"] that already had an entry"),h.TextureCache[b]=a)},b.removeFromCache=function(a){if("string"==typeof a){var b=h.TextureCache[a];if(b){var c=b.textureCacheIds.indexOf(a);return c> -1&&b.textureCacheIds.splice(c,1),delete h.TextureCache[a],b}}else if(a&&a.textureCacheIds){for(var d=0;d<a.textureCacheIds.length;++d)h.TextureCache[a.textureCacheIds[d]]===a&&delete h.TextureCache[a.textureCacheIds[d]];return a.textureCacheIds.length=0,a}return null},Object.defineProperty(b.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"frame",{get:function(){return this._frame},set:function(a){this._frame=a,this.noFrame=!1;var b=a.x,c=a.y,d=a.width,e=a.height,f=b+d>this.baseTexture.width,g=c+e>this.baseTexture.height;if(f||g){var h,i=f&&g?"and":"or";throw Error("Texture Error: frame does not fit inside the base Texture dimensions: "+("X: "+b+" + "+d+" = "+(b+d)+" > "+this.baseTexture.width+" "+i)+" "+("Y: "+c+" + "+e+" = "+(c+e)+" > ")+this.baseTexture.height)}this.valid=d&&e&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=a),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"rotate",{get:function(){return this._rotate},set:function(a){this._rotate=a,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),b.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(b,"EMPTY",{get:function(){return b._EMPTY||(b._EMPTY=new b(new u),K(b._EMPTY),K(b._EMPTY.baseTexture)),b._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(b,"WHITE",{get:function(){if(!b._WHITE){var a=f.Xd.ADAPTER.createCanvas(16,16),c=a.getContext("2d");a.width=16,a.height=16,c.fillStyle="white",c.fillRect(0,0,16,16),b._WHITE=new b(u.from(a)),K(b._WHITE),K(b._WHITE.baseTexture)}return b._WHITE},enumerable:!1,configurable:!0}),b}(h.EventEmitter),M=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d.valid=!0,d.filterFrame=null,d.filterPoolKey=null,d.updateUvs(),d}return p(b,a),Object.defineProperty(b.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(a){this.framebuffer.multisample=a},enumerable:!1,configurable:!0}),b.prototype.resize=function(a,b,c){void 0===c&&(c=!0);var d=this.baseTexture.resolution,e=Math.round(a*d)/d,f=Math.round(b*d)/d;this.valid=e>0&&f>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=f,c&&this.baseTexture.resize(e,f),this.updateUvs()},b.prototype.setResolution=function(a){var b=this.baseTexture;b.resolution!==a&&(b.setResolution(a),this.resize(b.width,b.height,!1))},b.create=function(a){for(var c=arguments,d=[],e=1;e<arguments.length;e++)d[e-1]=c[e];return"number"==typeof a&&((0,h.deprecation)("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),a={width:a,height:d[0],scaleMode:d[1],resolution:d[2]}),new b(new H(a))},b}(L),N=function(){function a(a){this.texturePool={},this.textureOptions=a||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return a.prototype.createTexture=function(a,b,c){void 0===c&&(c=g.G5.NONE);var d=new H(Object.assign({width:a,height:b,resolution:1,multisample:c},this.textureOptions));return new M(d)},a.prototype.getOptimalTexture=function(a,b,c,d){void 0===c&&(c=1),void 0===d&&(d=g.G5.NONE),a=Math.ceil(a*c-1e-6),b=Math.ceil(b*c-1e-6),this.enableFullScreen&&a===this._pixelsWidth&&b===this._pixelsHeight?e=d>1?-d:-1:(a=(0,h.nextPow2)(a),b=(0,h.nextPow2)(b),e=((65535&a)<<16|65535&b)>>>0,d>1&&(e+=4294967296*d)),this.texturePool[e]||(this.texturePool[e]=[]);var e,f=this.texturePool[e].pop();return f||(f=this.createTexture(a,b,d)),f.filterPoolKey=e,f.setResolution(c),f},a.prototype.getFilterTexture=function(a,b,c){var d=this.getOptimalTexture(a.width,a.height,b||a.resolution,c||g.G5.NONE);return d.filterFrame=a.filterFrame,d},a.prototype.returnTexture=function(a){var b=a.filterPoolKey;a.filterFrame=null,this.texturePool[b].push(a)},a.prototype.returnFilterTexture=function(a){this.returnTexture(a)},a.prototype.clear=function(a){if(a=!1!==a)for(var b in this.texturePool){var c=this.texturePool[b];if(c)for(var d=0;d<c.length;d++)c[d].destroy(!0)}this.texturePool={}},a.prototype.setScreenSize=function(a){if(a.width!==this._pixelsWidth||a.height!==this._pixelsHeight){for(var b in this.enableFullScreen=a.width>0&&a.height>0,this.texturePool)if(0>Number(b)){var c=this.texturePool[b];if(c)for(var d=0;d<c.length;d++)c[d].destroy(!0);this.texturePool[b]=[]}this._pixelsWidth=a.width,this._pixelsHeight=a.height}},a.SCREEN_KEY=-1,a}(),O=function(){function a(a,b,c,d,e,f,h){void 0===b&&(b=0),void 0===c&&(c=!1),void 0===d&&(d=g.vK.FLOAT),this.buffer=a,this.size=b,this.normalized=c,this.type=d,this.stride=e,this.start=f,this.instance=h}return a.prototype.destroy=function(){this.buffer=null},a.from=function(b,c,d,e,f){return new a(b,c,d,e,f)},a}(),P=0,Q=function(){function a(a,b,c){void 0===b&&(b=!0),void 0===c&&(c=!1),this.data=a||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=c,this.static=b,this.id=P++,this.disposeRunner=new j.R("disposeBuffer")}return a.prototype.update=function(a){a instanceof Array&&(a=new Float32Array(a)),this.data=a||this.data,this._updateID++},a.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},a.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(a.prototype,"index",{get:function(){return this.type===g.mr.ELEMENT_ARRAY_BUFFER},set:function(a){this.type=a?g.mr.ELEMENT_ARRAY_BUFFER:g.mr.ARRAY_BUFFER},enumerable:!1,configurable:!0}),a.from=function(b){return b instanceof Array&&(b=new Float32Array(b)),new a(b)},a}(),R={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array},S={5126:4,5123:2,5121:1},T=0,U={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},V=function(){function a(a,b){void 0===a&&(a=[]),void 0===b&&(b={}),this.buffers=a,this.indexBuffer=null,this.attributes=b,this.glVertexArrayObjects={},this.id=T++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new j.R("disposeGeometry"),this.refCount=0}return a.prototype.addAttribute=function(a,b,c,d,e,f,g,h){if(void 0===c&&(c=0),void 0===d&&(d=!1),void 0===h&&(h=!1),!b)throw Error("You must pass a buffer when creating an attribute");b instanceof Q||(b instanceof Array&&(b=new Float32Array(b)),b=new Q(b));var i=a.split("|");if(i.length>1){for(var j=0;j<i.length;j++)this.addAttribute(i[j],b,c,d,e);return this}var k=this.buffers.indexOf(b);return -1===k&&(this.buffers.push(b),k=this.buffers.length-1),this.attributes[a]=new O(k,c,d,e,f,g,h),this.instanced=this.instanced||h,this},a.prototype.getAttribute=function(a){return this.attributes[a]},a.prototype.getBuffer=function(a){return this.buffers[this.getAttribute(a).buffer]},a.prototype.addIndex=function(a){return a instanceof Q||(a instanceof Array&&(a=new Uint16Array(a)),a=new Q(a)),a.type=g.mr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=a,-1===this.buffers.indexOf(a)&&this.buffers.push(a),this},a.prototype.getIndex=function(){return this.indexBuffer},a.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var a,b=[],c=[],d=new Q;for(a in this.attributes){var e=this.attributes[a],f=this.buffers[e.buffer];b.push(f.data),c.push(e.size*S[e.type]/4),e.buffer=0}for(a=0,d.data=function(a,b){for(var c=0,d=0,e={},f=0;f<a.length;f++)d+=b[f],c+=a[f].length;for(var g=new ArrayBuffer(4*c),i=null,j=0,f=0;f<a.length;f++){var k=b[f],l=a[f],m=(0,h.getBufferType)(l);e[m]||(e[m]=new R[m](g)),i=e[m];for(var n=0;n<l.length;n++){var o=(n/k|0)*d+j,p=n%k;i[o+p]=l[n]}j+=k}return new Float32Array(g)}(b,c);a<this.buffers.length;a++)this.buffers[a]!==this.indexBuffer&&this.buffers[a].destroy();return this.buffers=[d],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},a.prototype.getSize=function(){for(var a in this.attributes){var b=this.attributes[a];return this.buffers[b.buffer].data.length/(b.stride/4||b.size)}return 0},a.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},a.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},a.prototype.clone=function(){for(var b=new a,c=0;c<this.buffers.length;c++)b.buffers[c]=new Q(this.buffers[c].data.slice(0));for(var c in this.attributes){var d=this.attributes[c];b.attributes[c]=new O(d.buffer,d.size,d.normalized,d.type,d.stride,d.start,d.instance)}return this.indexBuffer&&(b.indexBuffer=b.buffers[this.buffers.indexOf(this.indexBuffer)],b.indexBuffer.type=g.mr.ELEMENT_ARRAY_BUFFER),b},a.merge=function(b){for(var c,d=new a,e=[],f=[],i=[],j=0;j<b.length;j++){c=b[j];for(var k=0;k<c.buffers.length;k++)f[k]=f[k]||0,f[k]+=c.buffers[k].data.length,i[k]=0}for(var j=0;j<c.buffers.length;j++)e[j]=new U[(0,h.getBufferType)(c.buffers[j].data)](f[j]),d.buffers[j]=new Q(e[j]);for(var j=0;j<b.length;j++){c=b[j];for(var k=0;k<c.buffers.length;k++)e[k].set(c.buffers[k].data,i[k]),i[k]+=c.buffers[k].data.length}if(d.attributes=c.attributes,c.indexBuffer){d.indexBuffer=d.buffers[c.buffers.indexOf(c.indexBuffer)],d.indexBuffer.type=g.mr.ELEMENT_ARRAY_BUFFER;for(var l=0,m=0,n=0,o=0,j=0;j<c.buffers.length;j++)if(c.buffers[j]!==c.indexBuffer){o=j;break}for(var j in c.attributes){var p=c.attributes[j];(0|p.buffer)===o&&(m+=p.size*S[p.type]/4)}for(var j=0;j<b.length;j++){for(var q=b[j].indexBuffer.data,k=0;k<q.length;k++)d.indexBuffer.data[k+n]+=l;l+=b[j].buffers[o].data.length/m,n+=q.length}}return d},a}(),W=function(a){function b(){var b=a.call(this)||this;return b.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),b}return p(b,a),b}(V),X=function(a){function b(){var b=a.call(this)||this;return b.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),b.uvs=new Float32Array([0,0,1,0,1,1,0,1]),b.vertexBuffer=new Q(b.vertices),b.uvBuffer=new Q(b.uvs),b.addAttribute("aVertexPosition",b.vertexBuffer).addAttribute("aTextureCoord",b.uvBuffer).addIndex([0,1,2,0,2,3]),b}return p(b,a),b.prototype.map=function(a,b){var c=0,d=0;return this.uvs[0]=c,this.uvs[1]=d,this.uvs[2]=c+b.width/a.width,this.uvs[3]=d,this.uvs[4]=c+b.width/a.width,this.uvs[5]=d+b.height/a.height,this.uvs[6]=c,this.uvs[7]=d+b.height/a.height,c=b.x,d=b.y,this.vertices[0]=c,this.vertices[1]=d,this.vertices[2]=c+b.width,this.vertices[3]=d,this.vertices[4]=c+b.width,this.vertices[5]=d+b.height,this.vertices[6]=c,this.vertices[7]=d+b.height,this.invalidate(),this},b.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},b}(V),Y=0,Z=function(){function a(a,b,c){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Y++,this.static=!!b,this.ubo=!!c,a instanceof Q?(this.buffer=a,this.buffer.type=g.mr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=a,this.ubo&&(this.buffer=new Q(new Float32Array(1)),this.buffer.type=g.mr.UNIFORM_BUFFER,this.autoManage=!0))}return a.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},a.prototype.add=function(b,c,d){if(this.ubo)throw Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[b]=new a(c,d)},a.from=function(b,c,d){return new a(b,c,d)},a.uboFrom=function(b,c){return new a(b,null==c||c,!0)},a}(),$=function(){function a(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=g.G5.NONE,this.sourceFrame=new l.Ae,this.destinationFrame=new l.Ae,this.bindingSourceFrame=new l.Ae,this.bindingDestinationFrame=new l.Ae,this.filters=[],this.transform=null}return a.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},a}(),_=[new l.E9,new l.E9,new l.E9,new l.E9],aa=new l.y3,ab=function(){function a(a){this.renderer=a,this.defaultFilterStack=[{}],this.texturePool=new N,this.texturePool.setScreenSize(a.view),this.statePool=[],this.quad=new W,this.quadUv=new X,this.tempRect=new l.Ae,this.activeState={},this.globalUniforms=new Z({outputFrame:new l.Ae,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return a.prototype.push=function(a,b){for(var c,d,e=this.renderer,f=this.defaultFilterStack,g=this.statePool.pop()||new $,h=this.renderer.renderTexture,i=b[0].resolution,j=b[0].multisample,k=b[0].padding,l=b[0].autoFit,m=null===(c=b[0].legacy)|| void 0===c||c,n=1;n<b.length;n++){var o=b[n];i=Math.min(i,o.resolution),j=Math.min(j,o.multisample),k=this.useMaxPadding?Math.max(k,o.padding):k+o.padding,l=l&&o.autoFit,m=m||null===(d=o.legacy)|| void 0===d||d}1===f.length&&(this.defaultFilterStack[0].renderTexture=h.current),f.push(g),g.resolution=i,g.multisample=j,g.legacy=m,g.target=a,g.sourceFrame.copyFrom(a.filterArea||a.getBounds(!0)),g.sourceFrame.pad(k);var p=this.tempRect.copyFrom(h.sourceFrame);e.projection.transform&&this.transformAABB(aa.copyFrom(e.projection.transform).invert(),p),l?(g.sourceFrame.fit(p),(g.sourceFrame.width<=0||g.sourceFrame.height<=0)&&(g.sourceFrame.width=0,g.sourceFrame.height=0)):g.sourceFrame.intersects(p)||(g.sourceFrame.width=0,g.sourceFrame.height=0),this.roundFrame(g.sourceFrame,h.current?h.current.resolution:e.resolution,h.sourceFrame,h.destinationFrame,e.projection.transform),g.renderTexture=this.getOptimalFilterTexture(g.sourceFrame.width,g.sourceFrame.height,i,j),g.filters=b,g.destinationFrame.width=g.renderTexture.width,g.destinationFrame.height=g.renderTexture.height;var q=this.tempRect;q.x=0,q.y=0,q.width=g.sourceFrame.width,q.height=g.sourceFrame.height,g.renderTexture.filterFrame=g.sourceFrame,g.bindingSourceFrame.copyFrom(h.sourceFrame),g.bindingDestinationFrame.copyFrom(h.destinationFrame),g.transform=e.projection.transform,e.projection.transform=null,h.bind(g.renderTexture,g.sourceFrame,q),e.framebuffer.clear(0,0,0,0)},a.prototype.pop=function(){var a=this.defaultFilterStack,b=a.pop(),c=b.filters;this.activeState=b;var d=this.globalUniforms.uniforms;d.outputFrame=b.sourceFrame,d.resolution=b.resolution;var e=d.inputSize,f=d.inputPixel,h=d.inputClamp;if(e[0]=b.destinationFrame.width,e[1]=b.destinationFrame.height,e[2]=1/e[0],e[3]=1/e[1],f[0]=Math.round(e[0]*b.resolution),f[1]=Math.round(e[1]*b.resolution),f[2]=1/f[0],f[3]=1/f[1],h[0]=.5*f[2],h[1]=.5*f[3],h[2]=b.sourceFrame.width*e[2]-.5*f[2],h[3]=b.sourceFrame.height*e[3]-.5*f[3],b.legacy){var i=d.filterArea;i[0]=b.destinationFrame.width,i[1]=b.destinationFrame.height,i[2]=b.sourceFrame.x,i[3]=b.sourceFrame.y,d.filterClamp=d.inputClamp}this.globalUniforms.update();var j=a[a.length-1];if(this.renderer.framebuffer.blit(),1===c.length)c[0].apply(this,b.renderTexture,j.renderTexture,g.yl.BLEND,b),this.returnFilterTexture(b.renderTexture);else{var k=b.renderTexture,l=this.getOptimalFilterTexture(k.width,k.height,b.resolution);l.filterFrame=k.filterFrame;var m=0;for(m=0;m<c.length-1;++m){1===m&&b.multisample>1&&((l=this.getOptimalFilterTexture(k.width,k.height,b.resolution)).filterFrame=k.filterFrame),c[m].apply(this,k,l,g.yl.CLEAR,b);var n=k;k=l,l=n}c[m].apply(this,k,j.renderTexture,g.yl.BLEND,b),m>1&&b.multisample>1&&this.returnFilterTexture(b.renderTexture),this.returnFilterTexture(k),this.returnFilterTexture(l)}b.clear(),this.statePool.push(b)},a.prototype.bindAndClear=function(a,b){void 0===b&&(b=g.yl.CLEAR);var c=this.renderer,d=c.renderTexture,e=c.state;if(a===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,a&&a.filterFrame){var f=this.tempRect;f.x=0,f.y=0,f.width=a.filterFrame.width,f.height=a.filterFrame.height,d.bind(a,a.filterFrame,f)}else a!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?d.bind(a):this.renderer.renderTexture.bind(a,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var h=1&e.stateId||this.forceClear;(b===g.yl.CLEAR||b===g.yl.BLIT&&h)&&this.renderer.framebuffer.clear(0,0,0,0)},a.prototype.applyFilter=function(a,b,c,d){var e=this.renderer;e.state.set(a.state),this.bindAndClear(c,d),a.uniforms.uSampler=b,a.uniforms.filterGlobals=this.globalUniforms,e.shader.bind(a),a.legacy=!!a.program.attributeData.aTextureCoord,a.legacy?(this.quadUv.map(b._frame,b.filterFrame),e.geometry.bind(this.quadUv),e.geometry.draw(g.lg.TRIANGLES)):(e.geometry.bind(this.quad),e.geometry.draw(g.lg.TRIANGLE_STRIP))},a.prototype.calculateSpriteMatrix=function(a,b){var c=this.activeState,d=c.sourceFrame,e=c.destinationFrame,f=b._texture.orig,g=a.set(e.width,0,0,e.height,d.x,d.y),h=b.worldTransform.copyTo(l.y3.TEMP_MATRIX);return h.invert(),g.prepend(h),g.scale(1/f.width,1/f.height),g.translate(b.anchor.x,b.anchor.y),g},a.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},a.prototype.getOptimalFilterTexture=function(a,b,c,d){return void 0===c&&(c=1),void 0===d&&(d=g.G5.NONE),this.texturePool.getOptimalTexture(a,b,c,d)},a.prototype.getFilterTexture=function(a,b,c){if("number"==typeof a){var d=a;a=b,b=d}a=a||this.activeState.renderTexture;var e=this.texturePool.getOptimalTexture(a.width,a.height,b||a.resolution,c||g.G5.NONE);return e.filterFrame=a.filterFrame,e},a.prototype.returnFilterTexture=function(a){this.texturePool.returnTexture(a)},a.prototype.emptyPool=function(){this.texturePool.clear(!0)},a.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},a.prototype.transformAABB=function(a,b){var c=_[0],d=_[1],e=_[2],f=_[3];c.set(b.left,b.top),d.set(b.left,b.bottom),e.set(b.right,b.top),f.set(b.right,b.bottom),a.apply(c,c),a.apply(d,d),a.apply(e,e),a.apply(f,f);var g=Math.min(c.x,d.x,e.x,f.x),h=Math.min(c.y,d.y,e.y,f.y),i=Math.max(c.x,d.x,e.x,f.x),j=Math.max(c.y,d.y,e.y,f.y);b.x=g,b.y=h,b.width=i-g,b.height=j-h},a.prototype.roundFrame=function(a,b,c,d,e){if(!(a.width<=0)&&!(a.height<=0)&&!(c.width<=0)&&!(c.height<=0)){if(e){var f=e.a,g=e.b,h=e.c,i=e.d;if((Math.abs(g)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(f)>1e-4||Math.abs(i)>1e-4))return}(e=e?aa.copyFrom(e):aa.identity()).translate(-c.x,-c.y).scale(d.width/c.width,d.height/c.height).translate(d.x,d.y),this.transformAABB(e,a),a.ceil(b),this.transformAABB(e.invert(),a)}},a}(),ac=function(){function a(a){this.renderer=a}return a.prototype.flush=function(){},a.prototype.destroy=function(){this.renderer=null},a.prototype.start=function(){},a.prototype.stop=function(){this.flush()},a.prototype.render=function(a){},a}(),ad=function(){function a(a){this.renderer=a,this.emptyRenderer=new ac(a),this.currentRenderer=this.emptyRenderer}return a.prototype.setObjectRenderer=function(a){this.currentRenderer!==a&&(this.currentRenderer.stop(),this.currentRenderer=a,this.currentRenderer.start())},a.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},a.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},a.prototype.copyBoundTextures=function(a,b){for(var c=this.renderer.texture.boundTextures,d=b-1;d>=0;--d)a[d]=c[d]||null,a[d]&&(a[d]._batchLocation=d)},a.prototype.boundArray=function(a,b,c,d){for(var e=a.elements,f=a.ids,g=a.count,h=0,i=0;i<g;i++){var j=e[i],k=j._batchLocation;if(k>=0&&k<d&&b[k]===j){f[i]=k;continue}for(;h<d;){var l=b[h];if(l&&l._batchEnabled===c&&l._batchLocation===h){h++;continue}f[i]=h,j._batchLocation=h,b[h]=j;break}}},a.prototype.destroy=function(){this.renderer=null},a}(),ae=0,af=function(){function a(a){this.renderer=a,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),a.view.addEventListener("webglcontextlost",this.handleContextLost,!1),a.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(a.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),a.prototype.contextChange=function(a){this.gl=a,this.renderer.gl=a,this.renderer.CONTEXT_UID=ae++,a.isContextLost()&&a.getExtension("WEBGL_lose_context")&&a.getExtension("WEBGL_lose_context").restoreContext()},a.prototype.initFromContext=function(a){this.gl=a,this.validateContext(a),this.renderer.gl=a,this.renderer.CONTEXT_UID=ae++,this.renderer.runners.contextChange.emit(a)},a.prototype.initFromOptions=function(a){var b=this.createContext(this.renderer.view,a);this.initFromContext(b)},a.prototype.createContext=function(a,b){var c;if(f.Xd.PREFER_ENV>=g.Vi.WEBGL2&&(c=a.getContext("webgl2",b)),c)this.webGLVersion=2;else if(this.webGLVersion=1,!(c=a.getContext("webgl",b)||a.getContext("experimental-webgl",b)))throw Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=c,this.getExtensions(),this.gl},a.prototype.getExtensions=function(){var a=this.gl,b={anisotropicFiltering:a.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:a.getExtension("OES_texture_float_linear"),s3tc:a.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:a.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:a.getExtension("WEBGL_compressed_texture_etc"),etc1:a.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:a.getExtension("WEBGL_compressed_texture_atc"),astc:a.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,b,{drawBuffers:a.getExtension("WEBGL_draw_buffers"),depthTexture:a.getExtension("WEBGL_depth_texture"),loseContext:a.getExtension("WEBGL_lose_context"),vertexArrayObject:a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:a.getExtension("OES_element_index_uint"),floatTexture:a.getExtension("OES_texture_float"),floatTextureLinear:a.getExtension("OES_texture_float_linear"),textureHalfFloat:a.getExtension("OES_texture_half_float"),textureHalfFloatLinear:a.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,b,{colorBufferFloat:a.getExtension("EXT_color_buffer_float")})},a.prototype.handleContextLost=function(a){a.preventDefault()},a.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},a.prototype.destroy=function(){var a=this.renderer.view;this.renderer=null,a.removeEventListener("webglcontextlost",this.handleContextLost),a.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},a.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},a.prototype.validateContext=function(a){var b=a.getContextAttributes(),c="WebGL2RenderingContext"in globalThis&&a instanceof globalThis.WebGL2RenderingContext;c&&(this.webGLVersion=2),b&&!b.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var d=c||!!a.getExtension("OES_element_index_uint");this.supports.uint32Indices=d,d||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},a}(),ag=function(a){this.framebuffer=a,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=g.G5.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},ah=new l.Ae,ai=function(){function a(a){this.renderer=a,this.managedFramebuffers=[],this.unknownFramebuffer=new G(10,10),this.msaaSamples=null}return a.prototype.contextChange=function(){var a=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new l.Ae,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var b=this.renderer.context.extensions.drawBuffers,c=this.renderer.context.extensions.depthTexture;f.Xd.PREFER_ENV===g.Vi.WEBGL_LEGACY&&(b=null,c=null),b?a.drawBuffers=function(a){return b.drawBuffersWEBGL(a)}:(this.hasMRT=!1,a.drawBuffers=function(){}),c||(this.writeDepthTexture=!1)}else this.msaaSamples=a.getInternalformatParameter(a.RENDERBUFFER,a.RGBA8,a.SAMPLES)},a.prototype.bind=function(a,b,c){void 0===c&&(c=0);var d=this.gl;if(a){var e=a.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(a);this.current!==a&&(this.current=a,d.bindFramebuffer(d.FRAMEBUFFER,e.framebuffer)),e.mipLevel!==c&&(a.dirtyId++,a.dirtyFormat++,e.mipLevel=c),e.dirtyId!==a.dirtyId&&(e.dirtyId=a.dirtyId,e.dirtyFormat!==a.dirtyFormat?(e.dirtyFormat=a.dirtyFormat,e.dirtySize=a.dirtySize,this.updateFramebuffer(a,c)):e.dirtySize!==a.dirtySize&&(e.dirtySize=a.dirtySize,this.resizeFramebuffer(a)));for(var f=0;f<a.colorTextures.length;f++){var g=a.colorTextures[f];this.renderer.texture.unbind(g.parentTextureArray||g)}if(a.depthTexture&&this.renderer.texture.unbind(a.depthTexture),b){var h=b.width>>c,i=b.height>>c,j=h/b.width;this.setViewport(b.x*j,b.y*j,h,i)}else{var h=a.width>>c,i=a.height>>c;this.setViewport(0,0,h,i)}}else this.current&&(this.current=null,d.bindFramebuffer(d.FRAMEBUFFER,null)),b?this.setViewport(b.x,b.y,b.width,b.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},a.prototype.setViewport=function(a,b,c,d){var e=this.viewport;a=Math.round(a),b=Math.round(b),c=Math.round(c),d=Math.round(d),(e.width!==c||e.height!==d||e.x!==a||e.y!==b)&&(e.x=a,e.y=b,e.width=c,e.height=d,this.gl.viewport(a,b,c,d))},Object.defineProperty(a.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),a.prototype.clear=function(a,b,c,d,e){void 0===e&&(e=g.V0.COLOR|g.V0.DEPTH);var f=this.gl;f.clearColor(a,b,c,d),f.clear(e)},a.prototype.initFramebuffer=function(a){var b=this.gl,c=new ag(b.createFramebuffer());return c.multisample=this.detectSamples(a.multisample),a.glFramebuffers[this.CONTEXT_UID]=c,this.managedFramebuffers.push(a),a.disposeRunner.add(this),c},a.prototype.resizeFramebuffer=function(a){var b=this.gl,c=a.glFramebuffers[this.CONTEXT_UID];c.msaaBuffer&&(b.bindRenderbuffer(b.RENDERBUFFER,c.msaaBuffer),b.renderbufferStorageMultisample(b.RENDERBUFFER,c.multisample,b.RGBA8,a.width,a.height)),c.stencil&&(b.bindRenderbuffer(b.RENDERBUFFER,c.stencil),c.msaaBuffer?b.renderbufferStorageMultisample(b.RENDERBUFFER,c.multisample,b.DEPTH24_STENCIL8,a.width,a.height):b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,a.width,a.height));var d=a.colorTextures,e=d.length;b.drawBuffers||(e=Math.min(e,1));for(var f=0;f<e;f++){var g=d[f],h=g.parentTextureArray||g;this.renderer.texture.bind(h,0)}a.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(a.depthTexture,0)},a.prototype.updateFramebuffer=function(a,b){var c=this.gl,d=a.glFramebuffers[this.CONTEXT_UID],e=a.colorTextures,f=e.length;c.drawBuffers||(f=Math.min(f,1)),d.multisample>1&&this.canMultisampleFramebuffer(a)?(d.msaaBuffer=d.msaaBuffer||c.createRenderbuffer(),c.bindRenderbuffer(c.RENDERBUFFER,d.msaaBuffer),c.renderbufferStorageMultisample(c.RENDERBUFFER,d.multisample,c.RGBA8,a.width,a.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.RENDERBUFFER,d.msaaBuffer)):d.msaaBuffer&&(c.deleteRenderbuffer(d.msaaBuffer),d.msaaBuffer=null,d.blitFramebuffer&&(d.blitFramebuffer.dispose(),d.blitFramebuffer=null));for(var g=[],h=0;h<f;h++){var i=e[h],j=i.parentTextureArray||i;this.renderer.texture.bind(j,0),(0!==h||!d.msaaBuffer)&&(c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0+h,i.target,j._glTextures[this.CONTEXT_UID].texture,b),g.push(c.COLOR_ATTACHMENT0+h))}if(g.length>1&&c.drawBuffers(g),a.depthTexture&&this.writeDepthTexture){var k=a.depthTexture;this.renderer.texture.bind(k,0),c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.TEXTURE_2D,k._glTextures[this.CONTEXT_UID].texture,b)}(a.stencil||a.depth)&&!(a.depthTexture&&this.writeDepthTexture)?(d.stencil=d.stencil||c.createRenderbuffer(),c.bindRenderbuffer(c.RENDERBUFFER,d.stencil),d.msaaBuffer?c.renderbufferStorageMultisample(c.RENDERBUFFER,d.multisample,c.DEPTH24_STENCIL8,a.width,a.height):c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,a.width,a.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,d.stencil)):d.stencil&&(c.deleteRenderbuffer(d.stencil),d.stencil=null)},a.prototype.canMultisampleFramebuffer=function(a){return 1!==this.renderer.context.webGLVersion&&a.colorTextures.length<=1&&!a.depthTexture},a.prototype.detectSamples=function(a){var b=this.msaaSamples,c=g.G5.NONE;if(a<=1||null===b)return c;for(var d=0;d<b.length;d++)if(b[d]<=a){c=b[d];break}return 1===c&&(c=g.G5.NONE),c},a.prototype.blit=function(a,b,c){var d=this.current,e=this.renderer,f=this.gl,g=this.CONTEXT_UID;if(2===e.context.webGLVersion&&d){var h=d.glFramebuffers[g];if(h){if(!a){if(!h.msaaBuffer)return;var i=d.colorTextures[0];if(!i)return;h.blitFramebuffer||(h.blitFramebuffer=new G(d.width,d.height),h.blitFramebuffer.addColorTexture(0,i)),(a=h.blitFramebuffer).colorTextures[0]!==i&&(a.colorTextures[0]=i,a.dirtyId++,a.dirtyFormat++),(a.width!==d.width||a.height!==d.height)&&(a.width=d.width,a.height=d.height,a.dirtyId++,a.dirtySize++)}b||((b=ah).width=d.width,b.height=d.height),c||(c=b);var j=b.width===c.width&&b.height===c.height;this.bind(a),f.bindFramebuffer(f.READ_FRAMEBUFFER,h.framebuffer),f.blitFramebuffer(b.left,b.top,b.right,b.bottom,c.left,c.top,c.right,c.bottom,f.COLOR_BUFFER_BIT,j?f.NEAREST:f.LINEAR)}}},a.prototype.disposeFramebuffer=function(a,b){var c=a.glFramebuffers[this.CONTEXT_UID],d=this.gl;if(c){delete a.glFramebuffers[this.CONTEXT_UID];var e=this.managedFramebuffers.indexOf(a);e>=0&&this.managedFramebuffers.splice(e,1),a.disposeRunner.remove(this),!b&&(d.deleteFramebuffer(c.framebuffer),c.msaaBuffer&&d.deleteRenderbuffer(c.msaaBuffer),c.stencil&&d.deleteRenderbuffer(c.stencil)),c.blitFramebuffer&&c.blitFramebuffer.dispose()}},a.prototype.disposeAll=function(a){var b=this.managedFramebuffers;this.managedFramebuffers=[];for(var c=0;c<b.length;c++)this.disposeFramebuffer(b[c],a)},a.prototype.forceStencil=function(){var a=this.current;if(a){var b=a.glFramebuffers[this.CONTEXT_UID];if(b&&!b.stencil){a.stencil=!0;var c=a.width,d=a.height,e=this.gl,f=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,f),b.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,b.multisample,e.DEPTH24_STENCIL8,c,d):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,c,d),b.stencil=f,e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,f)}}},a.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new l.Ae},a.prototype.destroy=function(){this.renderer=null},a}(),aj={5126:4,5123:2,5121:1},ak=function(){function a(a){this.renderer=a,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return a.prototype.contextChange=function(){this.disposeAll(!0);var a=this.gl=this.renderer.gl,b=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==b.webGLVersion){var c=this.renderer.context.extensions.vertexArrayObject;f.Xd.PREFER_ENV===g.Vi.WEBGL_LEGACY&&(c=null),c?(a.createVertexArray=function(){return c.createVertexArrayOES()},a.bindVertexArray=function(a){return c.bindVertexArrayOES(a)},a.deleteVertexArray=function(a){return c.deleteVertexArrayOES(a)}):(this.hasVao=!1,a.createVertexArray=function(){return null},a.bindVertexArray=function(){return null},a.deleteVertexArray=function(){return null})}if(2!==b.webGLVersion){var d=a.getExtension("ANGLE_instanced_arrays");d?(a.vertexAttribDivisor=function(a,b){return d.vertexAttribDivisorANGLE(a,b)},a.drawElementsInstanced=function(a,b,c,e,f){return d.drawElementsInstancedANGLE(a,b,c,e,f)},a.drawArraysInstanced=function(a,b,c,e){return d.drawArraysInstancedANGLE(a,b,c,e)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===b.webGLVersion||!!b.extensions.uint32ElementIndex},a.prototype.bind=function(a,b){b=b||this.renderer.shader.shader;var c=this.gl,d=a.glVertexArrayObjects[this.CONTEXT_UID],e=!1;d||(this.managedGeometries[a.id]=a,a.disposeRunner.add(this),a.glVertexArrayObjects[this.CONTEXT_UID]=d={},e=!0);var f=d[b.program.id]||this.initGeometryVao(a,b,e);this._activeGeometry=a,this._activeVao!==f&&(this._activeVao=f,this.hasVao?c.bindVertexArray(f):this.activateVao(a,b.program)),this.updateBuffers()},a.prototype.reset=function(){this.unbind()},a.prototype.updateBuffers=function(){for(var a=this._activeGeometry,b=this.renderer.buffer,c=0;c<a.buffers.length;c++){var d=a.buffers[c];b.update(d)}},a.prototype.checkCompatibility=function(a,b){var c=a.attributes,d=b.attributeData;for(var e in d)if(!c[e])throw Error('shader and geometry incompatible, geometry missing the "'+e+'" attribute')},a.prototype.getSignature=function(a,b){var c=a.attributes,d=b.attributeData,e=["g",a.id];for(var f in c)d[f]&&e.push(f,d[f].location);return e.join("-")},a.prototype.initGeometryVao=function(a,b,c){void 0===c&&(c=!0);var d=this.gl,e=this.CONTEXT_UID,f=this.renderer.buffer,g=b.program;g.glPrograms[e]||this.renderer.shader.generateProgram(b),this.checkCompatibility(a,g);var h=this.getSignature(a,g),i=a.glVertexArrayObjects[this.CONTEXT_UID],j=i[h];if(j)return i[g.id]=j,j;var k=a.buffers,l=a.attributes,m={},n={};for(var o in k)m[o]=0,n[o]=0;for(var o in l)!l[o].size&&g.attributeData[o]?l[o].size=g.attributeData[o].size:l[o].size||console.warn("PIXI Geometry attribute '"+o+"' size cannot be determined (likely the bound shader does not have the attribute)"),m[l[o].buffer]+=l[o].size*aj[l[o].type];for(var o in l){var p=l[o],q=p.size;void 0===p.stride&&(m[p.buffer]===q*aj[p.type]?p.stride=0:p.stride=m[p.buffer]),void 0===p.start&&(p.start=n[p.buffer],n[p.buffer]+=q*aj[p.type])}j=d.createVertexArray(),d.bindVertexArray(j);for(var r=0;r<k.length;r++){var s=k[r];f.bind(s),c&&s._glBuffers[e].refCount++}return this.activateVao(a,g),this._activeVao=j,i[g.id]=j,i[h]=j,j},a.prototype.disposeGeometry=function(a,b){if(this.managedGeometries[a.id]){delete this.managedGeometries[a.id];var c,d=a.glVertexArrayObjects[this.CONTEXT_UID],e=this.gl,f=a.buffers,g=null===(c=this.renderer)|| void 0===c?void 0:c.buffer;if(a.disposeRunner.remove(this),d){if(g)for(var h=0;h<f.length;h++){var i=f[h]._glBuffers[this.CONTEXT_UID];i&&(i.refCount--,0!==i.refCount||b||g.dispose(f[h],b))}if(!b){for(var j in d)if("g"===j[0]){var k=d[j];this._activeVao===k&&this.unbind(),e.deleteVertexArray(k)}}delete a.glVertexArrayObjects[this.CONTEXT_UID]}}},a.prototype.disposeAll=function(a){for(var b=Object.keys(this.managedGeometries),c=0;c<b.length;c++)this.disposeGeometry(this.managedGeometries[b[c]],a)},a.prototype.activateVao=function(a,b){var c=this.gl,d=this.CONTEXT_UID,e=this.renderer.buffer,f=a.buffers,g=a.attributes;a.indexBuffer&&e.bind(a.indexBuffer);var h=null;for(var i in g){var j=g[i],k=f[j.buffer],l=k._glBuffers[d];if(b.attributeData[i]){h!==l&&(e.bind(k),h=l);var m=b.attributeData[i].location;if(c.enableVertexAttribArray(m),c.vertexAttribPointer(m,j.size,j.type||c.FLOAT,j.normalized,j.stride,j.start),j.instance){if(this.hasInstance)c.vertexAttribDivisor(m,1);else throw Error("geometry error, GPU Instancing is not supported on this device")}}}},a.prototype.draw=function(a,b,c,d){var e=this.gl,f=this._activeGeometry;if(f.indexBuffer){var g=f.indexBuffer.data.BYTES_PER_ELEMENT,h=2===g?e.UNSIGNED_SHORT:e.UNSIGNED_INT;2===g||4===g&&this.canUseUInt32ElementIndex?f.instanced?e.drawElementsInstanced(a,b||f.indexBuffer.data.length,h,(c||0)*g,d||1):e.drawElements(a,b||f.indexBuffer.data.length,h,(c||0)*g):console.warn("unsupported index buffer type: uint32")}else f.instanced?e.drawArraysInstanced(a,c,b||f.getSize(),d||1):e.drawArrays(a,c,b||f.getSize());return this},a.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},a.prototype.destroy=function(){this.renderer=null},a}(),al=function(){function a(a){void 0===a&&(a=null),this.type=g.A7.NONE,this.autoDetect=!0,this.maskObject=a||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=f.Xd.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(a.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(a){a?this._filters?this._filters[0]=a:this._filters=[a]:this._filters=null},enumerable:!1,configurable:!0}),a.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=g.A7.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},a.prototype.copyCountersOrReset=function(a){a?(this._stencilCounter=a._stencilCounter,this._scissorCounter=a._scissorCounter,this._scissorRect=a._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},a}();function am(a,b,c){var d=a.createShader(b);return a.shaderSource(d,c),a.compileShader(d),d}function an(a,b){var c=a.getShaderSource(b).split("\n").map(function(a,b){return b+": "+a}),d=a.getShaderInfoLog(b),e=d.split("\n"),f={},g=e.map(function(a){return parseFloat(a.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(a){return!!a&&!f[a]&&(f[a]=!0,!0)}),h=[""];g.forEach(function(a){c[a-1]="%c"+c[a-1]+"%c",h.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var i=c.join("\n");h[0]=i,console.error(d),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,h),console.groupEnd()}function ao(a){for(var b=Array(a),c=0;c<b.length;c++)b[c]=!1;return b}function ap(a,b){switch(a){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*b);case"vec3":return new Float32Array(3*b);case"vec4":return new Float32Array(4*b);case"ivec2":return new Int32Array(2*b);case"ivec3":return new Int32Array(3*b);case"ivec4":return new Int32Array(4*b);case"uvec2":return new Uint32Array(2*b);case"uvec3":return new Uint32Array(3*b);case"uvec4":return new Uint32Array(4*b);case"bool":return!1;case"bvec2":return ao(2*b);case"bvec3":return ao(3*b);case"bvec4":return ao(4*b);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var aq={},ar=aq;function as(a,b,c){if("precision"!==a.substring(0,9)){var d=b;return b===g.cB.HIGH&&c!==g.cB.HIGH&&(d=g.cB.MEDIUM),"precision "+d+" float;\n"+a}return c!==g.cB.HIGH&&"precision highp"===a.substring(0,15)?a.replace("precision highp","precision mediump"):a}var at={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},au=null,av={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function aw(a,b){if(!au){var c=Object.keys(av);au={};for(var d=0;d<c.length;++d){var e=c[d];au[a[e]]=av[e]}}return au[b]}var ax=[{test:function(a){return"float"===a.type&&1===a.size},code:function(a){return'\n            if(uv["'+a+'"] !== ud["'+a+'"].value)\n            {\n                ud["'+a+'"].value = uv["'+a+'"]\n                gl.uniform1f(ud["'+a+'"].location, uv["'+a+'"])\n            }\n            '}},{test:function(a){return("sampler2D"===a.type||"samplerCube"===a.type||"sampler2DArray"===a.type)&&1===a.size&&!a.isArray},code:function(a){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+a+'"], t);\n\n            if(ud["'+a+'"].value !== t)\n            {\n                ud["'+a+'"].value = t;\n                gl.uniform1i(ud["'+a+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(a,b){return"mat3"===a.type&&1===a.size&& void 0!==b.a},code:function(a){return'\n            gl.uniformMatrix3fv(ud["'+a+'"].location, false, uv["'+a+'"].toArray(true));\n            '},codeUbo:function(a){return"\n                var "+a+"_matrix = uv."+a+".toArray(true);\n\n                data[offset] = "+a+"_matrix[0];\n                data[offset+1] = "+a+"_matrix[1];\n                data[offset+2] = "+a+"_matrix[2];\n        \n                data[offset + 4] = "+a+"_matrix[3];\n                data[offset + 5] = "+a+"_matrix[4];\n                data[offset + 6] = "+a+"_matrix[5];\n        \n                data[offset + 8] = "+a+"_matrix[6];\n                data[offset + 9] = "+a+"_matrix[7];\n                data[offset + 10] = "+a+"_matrix[8];\n            "}},{test:function(a,b){return"vec2"===a.type&&1===a.size&& void 0!==b.x},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+a+'"].location, v.x, v.y);\n                }'},codeUbo:function(a){return"\n                v = uv."+a+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(a){return"vec2"===a.type&&1===a.size},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+a+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(a,b){return"vec4"===a.type&&1===a.size&& void 0!==b.width},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+a+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(a){return"\n                    v = uv."+a+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(a){return"vec4"===a.type&&1===a.size},code:function(a){return'\n                cv = ud["'+a+'"].value;\n                v = uv["'+a+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+a+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],ay={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},az={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function aA(a){for(var b="",c=0;c<a;++c)c>0&&(b+="\nelse "),c<a-1&&(b+="if(test == "+c+".0){}");return b}var aB=0,aC={},aD=function(){function a(b,c,e){void 0===e&&(e="pixi-shader"),this.id=aB++,this.vertexSrc=b||a.defaultVertexSrc,this.fragmentSrc=c||a.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(aC[e=e.replace(/\s+/g,"-")]?(aC[e]++,e+="-"+aC[e]):aC[e]=1,this.vertexSrc="#define SHADER_NAME "+e+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+e+"\n"+this.fragmentSrc,this.vertexSrc=as(this.vertexSrc,f.Xd.PRECISION_VERTEX,g.cB.HIGH),this.fragmentSrc=as(this.fragmentSrc,f.Xd.PRECISION_FRAGMENT,function(){if(!d){d=g.cB.MEDIUM;var a=function(){if(ar===aq||ar&&ar.isContextLost()){var a=f.Xd.ADAPTER.createCanvas(),b=void 0;f.Xd.PREFER_ENV>=g.Vi.WEBGL2&&(b=a.getContext("webgl2",{})),b||((b=a.getContext("webgl",{})||a.getContext("experimental-webgl",{}))?b.getExtension("WEBGL_draw_buffers"):b=null),ar=b}return ar}();a&&a.getShaderPrecisionFormat&&(d=a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision?g.cB.HIGH:g.cB.MEDIUM)}return d}())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(a,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),a.from=function(b,c,d){var e=b+c,f=h.ProgramCache[e];return f||(h.ProgramCache[e]=f=new a(b,c,d)),f},a}(),aE=function(){function a(a,b){this.uniformBindCount=0,this.program=a,b?b instanceof Z?this.uniformGroup=b:this.uniformGroup=new Z(b):this.uniformGroup=new Z({})}return a.prototype.checkUniformExists=function(a,b){if(b.uniforms[a])return!0;for(var c in b.uniforms){var d=b.uniforms[c];if(d.group&&this.checkUniformExists(a,d))return!0}return!1},a.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(a.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),a.from=function(b,c,d){var e=aD.from(b,c);return new a(e,d)},a}(),aF=function(){function a(){this.data=0,this.blendMode=g.T$.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(a.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(a){!!(1&this.data)!==a&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(a){!!(2&this.data)!==a&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(a){!!(4&this.data)!==a&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(a){!!(8&this.data)!==a&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(a){!!(32&this.data)!==a&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(a){!!(16&this.data)!==a&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"blendMode",{get:function(){return this._blendMode},set:function(a){this.blend=a!==g.T$.NONE,this._blendMode=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(a){this.offsets=!!a,this._polygonOffset=a},enumerable:!1,configurable:!0}),a.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},a.for2d=function(){var b=new a;return b.depthTest=!1,b.blend=!0,b},a}(),aG=function(a){function b(c,d,e){var g=this,h=aD.from(c||b.defaultVertexSrc,d||b.defaultFragmentSrc);return(g=a.call(this,h,e)||this).padding=0,g.resolution=f.Xd.FILTER_RESOLUTION,g.multisample=f.Xd.FILTER_MULTISAMPLE,g.enabled=!0,g.autoFit=!0,g.state=new aF,g}return p(b,a),b.prototype.apply=function(a,b,c,d,e){a.applyFilter(this,b,c,d)},Object.defineProperty(b.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(a){this.state.blendMode=a},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"resolution",{get:function(){return this._resolution},set:function(a){this._resolution=a},enumerable:!1,configurable:!0}),Object.defineProperty(b,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(b,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),b}(aE),aH=new l.y3,aI=function(){function a(a,b){this._texture=a,this.mapCoord=new l.y3,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===b?.5:b,this.isSimple=!1}return Object.defineProperty(a.prototype,"texture",{get:function(){return this._texture},set:function(a){this._texture=a,this._textureID=-1},enumerable:!1,configurable:!0}),a.prototype.multiplyUvs=function(a,b){void 0===b&&(b=a);for(var c=this.mapCoord,d=0;d<a.length;d+=2){var e=a[d],f=a[d+1];b[d]=e*c.a+f*c.c+c.tx,b[d+1]=e*c.b+f*c.d+c.ty}return b},a.prototype.update=function(a){var b=this._texture;if(!b||!b.valid|| !a&&this._textureID===b._updateID)return!1;this._textureID=b._updateID,this._updateID++;var c=b._uvs;this.mapCoord.set(c.x1-c.x0,c.y1-c.y0,c.x3-c.x0,c.y3-c.y0,c.x0,c.y0);var d=b.orig,e=b.trim;e&&(aH.set(d.width/e.width,0,0,d.height/e.height,-e.x/e.width,-e.y/e.height),this.mapCoord.append(aH));var f=b.baseTexture,g=this.uClampFrame,h=this.clampMargin/f.resolution,i=this.clampOffset;return g[0]=(b._frame.x+h+i)/f.width,g[1]=(b._frame.y+h+i)/f.height,g[2]=(b._frame.x+b._frame.width-h+i)/f.width,g[3]=(b._frame.y+b._frame.height-h+i)/f.height,this.uClampOffset[0]=i/f.realWidth,this.uClampOffset[1]=i/f.realHeight,this.isSimple=b._frame.width===f.width&&b._frame.height===f.height&&0===b.rotate,!0},a}(),aJ=function(a){function b(b,c,d){var e=this,f=null;return"string"!=typeof b&& void 0===c&& void 0===d&&(f=b,b=void 0,c=void 0,d=void 0),(e=a.call(this,b||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",c||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",d)||this).maskSprite=f,e.maskMatrix=new l.y3,e}return p(b,a),Object.defineProperty(b.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(a){this._maskSprite=a,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),b.prototype.apply=function(a,b,c,d){var e=this._maskSprite,f=e._texture;f.valid&&(f.uvMatrix||(f.uvMatrix=new aI(f,0)),f.uvMatrix.update(),this.uniforms.npmAlpha=f.baseTexture.alphaMode?0:1,this.uniforms.mask=f,this.uniforms.otherMatrix=a.calculateSpriteMatrix(this.maskMatrix,e).prepend(f.uvMatrix.mapCoord),this.uniforms.alpha=e.worldAlpha,this.uniforms.maskClamp=f.uvMatrix.uClampFrame,a.applyFilter(this,b,c,d))},b}(aG),aK=function(){function a(a){this.renderer=a,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return a.prototype.setMaskStack=function(a){this.maskStack=a,this.renderer.scissor.setMaskStack(a),this.renderer.stencil.setMaskStack(a)},a.prototype.push=function(a,b){var c=b;if(!c.isMaskData){var d=this.maskDataPool.pop()||new al;d.pooled=!0,d.maskObject=b,c=d}var e=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(c.copyCountersOrReset(e),c._colorMask=e?e._colorMask:15,c.autoDetect&&this.detect(c),c._target=a,c.type!==g.A7.SPRITE&&this.maskStack.push(c),c.enabled)switch(c.type){case g.A7.SCISSOR:this.renderer.scissor.push(c);break;case g.A7.STENCIL:this.renderer.stencil.push(c);break;case g.A7.SPRITE:c.copyCountersOrReset(null),this.pushSpriteMask(c);break;case g.A7.COLOR:this.pushColorMask(c)}c.type===g.A7.SPRITE&&this.maskStack.push(c)},a.prototype.pop=function(a){var b=this.maskStack.pop();if(b&&b._target===a){if(b.enabled)switch(b.type){case g.A7.SCISSOR:this.renderer.scissor.pop(b);break;case g.A7.STENCIL:this.renderer.stencil.pop(b.maskObject);break;case g.A7.SPRITE:this.popSpriteMask(b);break;case g.A7.COLOR:this.popColorMask(b)}if(b.reset(),b.pooled&&this.maskDataPool.push(b),0!==this.maskStack.length){var c=this.maskStack[this.maskStack.length-1];c.type===g.A7.SPRITE&&c._filters&&(c._filters[0].maskSprite=c.maskObject)}}},a.prototype.detect=function(a){var b=a.maskObject;b?b.isSprite?a.type=g.A7.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(a)?a.type=g.A7.SCISSOR:a.type=g.A7.STENCIL:a.type=g.A7.COLOR},a.prototype.pushSpriteMask=function(a){var b,c,d,e,f=a.maskObject,g=a._target,h=a._filters;h||(h=this.alphaMaskPool[this.alphaMaskIndex])||(h=this.alphaMaskPool[this.alphaMaskIndex]=[new aJ]);var i=this.renderer,j=i.renderTexture;if(j.current){var k=j.current;d=a.resolution||k.resolution,e=null!==(b=a.multisample)&& void 0!==b?b:k.multisample}else d=a.resolution||i.resolution,e=null!==(c=a.multisample)&& void 0!==c?c:i.multisample;h[0].resolution=d,h[0].multisample=e,h[0].maskSprite=f;var l=g.filterArea;g.filterArea=f.getBounds(!0),i.filter.push(g,h),g.filterArea=l,!a._filters&&this.alphaMaskIndex++},a.prototype.popSpriteMask=function(a){this.renderer.filter.pop(),a._filters?a._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},a.prototype.pushColorMask=function(a){var b=a._colorMask,c=a._colorMask=b&a.colorMask;c!==b&&this.renderer.gl.colorMask((1&c)!=0,(2&c)!=0,(4&c)!=0,(8&c)!=0)},a.prototype.popColorMask=function(a){var b=a._colorMask,c=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;c!==b&&this.renderer.gl.colorMask((1&c)!=0,(2&c)!=0,(4&c)!=0,(8&c)!=0)},a.prototype.destroy=function(){this.renderer=null},a}(),aL=function(){function a(a){this.renderer=a,this.maskStack=[],this.glConst=0}return a.prototype.getStackLength=function(){return this.maskStack.length},a.prototype.setMaskStack=function(a){var b=this.renderer.gl,c=this.getStackLength();this.maskStack=a;var d=this.getStackLength();d!==c&&(0===d?b.disable(this.glConst):(b.enable(this.glConst),this._useCurrent()))},a.prototype._useCurrent=function(){},a.prototype.destroy=function(){this.renderer=null,this.maskStack=null},a}(),aM=new l.y3,aN=[],aO=function(a){function b(b){var c=a.call(this,b)||this;return c.glConst=f.Xd.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,c}return p(b,a),b.prototype.getStackLength=function(){var a=this.maskStack[this.maskStack.length-1];return a?a._scissorCounter:0},b.prototype.calcScissorRect=function(a){if(!a._scissorRectLocal){var b,c=a._scissorRect,d=a.maskObject,e=this.renderer,f=e.renderTexture,g=d.getBounds(!0,null!==(b=aN.pop())&& void 0!==b?b:new l.Ae);this.roundFrameToPixels(g,f.current?f.current.resolution:e.resolution,f.sourceFrame,f.destinationFrame,e.projection.transform),c&&g.fit(c),a._scissorRectLocal=g}},b.isMatrixRotated=function(a){if(!a)return!1;var b=a.a,c=a.b,d=a.c,e=a.d;return(Math.abs(c)>1e-4||Math.abs(d)>1e-4)&&(Math.abs(b)>1e-4||Math.abs(e)>1e-4)},b.prototype.testScissor=function(a){var c=a.maskObject;if(!c.isFastRect||!c.isFastRect()||b.isMatrixRotated(c.worldTransform)||b.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(a);var d=a._scissorRectLocal;return d.width>0&&d.height>0},b.prototype.roundFrameToPixels=function(a,c,d,e,f){!b.isMatrixRotated(f)&&((f=f?aM.copyFrom(f):aM.identity()).translate(-d.x,-d.y).scale(e.width/d.width,e.height/d.height).translate(e.x,e.y),this.renderer.filter.transformAABB(f,a),a.fit(e),a.x=Math.round(a.x*c),a.y=Math.round(a.y*c),a.width=Math.round(a.width*c),a.height=Math.round(a.height*c))},b.prototype.push=function(a){a._scissorRectLocal||this.calcScissorRect(a);var b=this.renderer.gl;a._scissorRect||b.enable(b.SCISSOR_TEST),a._scissorCounter++,a._scissorRect=a._scissorRectLocal,this._useCurrent()},b.prototype.pop=function(a){var b=this.renderer.gl;a&&aN.push(a._scissorRectLocal),this.getStackLength()>0?this._useCurrent():b.disable(b.SCISSOR_TEST)},b.prototype._useCurrent=function(){var a,b=this.maskStack[this.maskStack.length-1]._scissorRect;a=this.renderer.renderTexture.current?b.y:this.renderer.height-b.height-b.y,this.renderer.gl.scissor(b.x,a,b.width,b.height)},b}(aL),aP=function(a){function b(b){var c=a.call(this,b)||this;return c.glConst=f.Xd.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,c}return p(b,a),b.prototype.getStackLength=function(){var a=this.maskStack[this.maskStack.length-1];return a?a._stencilCounter:0},b.prototype.push=function(a){var b=a.maskObject,c=this.renderer.gl,d=a._stencilCounter;0===d&&(this.renderer.framebuffer.forceStencil(),c.clearStencil(0),c.clear(c.STENCIL_BUFFER_BIT),c.enable(c.STENCIL_TEST)),a._stencilCounter++;var e=a._colorMask;0!==e&&(a._colorMask=0,c.colorMask(!1,!1,!1,!1)),c.stencilFunc(c.EQUAL,d,4294967295),c.stencilOp(c.KEEP,c.KEEP,c.INCR),b.renderable=!0,b.render(this.renderer),this.renderer.batch.flush(),b.renderable=!1,0!==e&&(a._colorMask=e,c.colorMask((1&e)!=0,(2&e)!=0,(4&e)!=0,(8&e)!=0)),this._useCurrent()},b.prototype.pop=function(a){var b=this.renderer.gl;if(0===this.getStackLength())b.disable(b.STENCIL_TEST);else{var c=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,d=c?c._colorMask:15;0!==d&&(c._colorMask=0,b.colorMask(!1,!1,!1,!1)),b.stencilOp(b.KEEP,b.KEEP,b.DECR),a.renderable=!0,a.render(this.renderer),this.renderer.batch.flush(),a.renderable=!1,0!==d&&(c._colorMask=d,b.colorMask((1&d)!=0,(2&d)!=0,(4&d)!=0,(8&d)!=0)),this._useCurrent()}},b.prototype._useCurrent=function(){var a=this.renderer.gl;a.stencilFunc(a.EQUAL,this.getStackLength(),4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP)},b}(aL),aQ=function(){function a(a){this.renderer=a,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new l.y3,this.transform=null}return a.prototype.update=function(a,b,c,d){this.destinationFrame=a||this.destinationFrame||this.defaultFrame,this.sourceFrame=b||this.sourceFrame||a,this.calculateProjection(this.destinationFrame,this.sourceFrame,c,d),this.transform&&this.projectionMatrix.append(this.transform);var e=this.renderer;e.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,e.globalUniforms.update(),e.shader.shader&&e.shader.syncUniformGroup(e.shader.shader.uniforms.globals)},a.prototype.calculateProjection=function(a,b,c,d){var e=this.projectionMatrix,f=d?-1:1;e.identity(),e.a=1/b.width*2,e.d=f*(1/b.height*2),e.tx=-1-b.x*e.a,e.ty=-f-b.y*e.d},a.prototype.setTransform=function(a){},a.prototype.destroy=function(){this.renderer=null},a}(),aR=new l.Ae,aS=new l.Ae,aT=function(){function a(a){this.renderer=a,this.clearColor=a._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new l.Ae,this.destinationFrame=new l.Ae,this.viewportFrame=new l.Ae}return a.prototype.bind=function(a,b,c){void 0===a&&(a=null);var d,e,f,g=this.renderer;this.current=a,a?(f=(d=a.baseTexture).resolution,b||(aR.width=a.frame.width,aR.height=a.frame.height,b=aR),c||(aS.x=a.frame.x,aS.y=a.frame.y,aS.width=b.width,aS.height=b.height,c=aS),e=d.framebuffer):(f=g.resolution,b||(aR.width=g.screen.width,aR.height=g.screen.height,b=aR),c||((c=aR).width=b.width,c.height=b.height));var h=this.viewportFrame;h.x=c.x*f,h.y=c.y*f,h.width=c.width*f,h.height=c.height*f,a||(h.y=g.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(e,h),this.renderer.projection.update(c,b,f,!e),a?this.renderer.mask.setMaskStack(d.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(b),this.destinationFrame.copyFrom(c)},a.prototype.clear=function(a,b){a=this.current?a||this.current.baseTexture.clearColor:a||this.clearColor;var c=this.destinationFrame,d=this.current?this.current.baseTexture:this.renderer.screen,e=c.width!==d.width||c.height!==d.height;if(e){var f=this.viewportFrame,g=f.x,h=f.y,i=f.width,j=f.height;g=Math.round(g),h=Math.round(h),i=Math.round(i),j=Math.round(j),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(g,h,i,j)}this.renderer.framebuffer.clear(a[0],a[1],a[2],a[3],b),e&&this.renderer.scissor.pop()},a.prototype.resize=function(){this.bind(null)},a.prototype.reset=function(){this.bind(null)},a.prototype.destroy=function(){this.renderer=null},a}();function aU(a,b,c,d,e){c.buffer.update(e)}var aV={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},aW={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64},aX=function(){function a(a,b){this.program=a,this.uniformData=b,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return a.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},a}(),aY=0,aZ={textureCount:0,uboCount:0},a$=function(){function a(a){this.destroyed=!1,this.renderer=a,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=aY++}return a.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof e)return e;try{var a=Function("param1","param2","param3","return param1[param2] === param3;");e=!0===a({a:"b"},"a","b")}catch(b){e=!1}return e}())throw Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},a.prototype.contextChange=function(a){this.gl=a,this.reset()},a.prototype.bind=function(a,b){a.uniforms.globals=this.renderer.globalUniforms;var c=a.program,d=c.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(a);return this.shader=a,this.program!==c&&(this.program=c,this.gl.useProgram(d.program)),b||(aZ.textureCount=0,aZ.uboCount=0,this.syncUniformGroup(a.uniformGroup,aZ)),d},a.prototype.setUniforms=function(a){var b=this.shader.program,c=b.glPrograms[this.renderer.CONTEXT_UID];b.syncUniforms(c.uniformData,a,this.renderer)},a.prototype.syncUniformGroup=function(a,b){var c=this.getGlProgram();a.static&&a.dirtyId===c.uniformDirtyGroups[a.id]||(c.uniformDirtyGroups[a.id]=a.dirtyId,this.syncUniforms(a,c,b))},a.prototype.syncUniforms=function(a,b,c){(a.syncUniforms[this.shader.program.id]||this.createSyncGroups(a))(b.uniformData,a.uniforms,this.renderer,c)},a.prototype.createSyncGroups=function(a){var b=this.getSignature(a,this.shader.program.uniformData,"u");return this.cache[b]||(this.cache[b]=function(a,b){var c,d=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var e in a.uniforms){var f=b[e];if(!f){(null===(c=a.uniforms[e])|| void 0===c?void 0:c.group)&&(a.uniforms[e].ubo?d.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+e+", '"+e+"');\n                    "):d.push("\n                        renderer.shader.syncUniformGroup(uv."+e+", syncData);\n                    "));continue}for(var g=a.uniforms[e],h=!1,i=0;i<ax.length;i++)if(ax[i].test(f,g)){d.push(ax[i].code(e,g)),h=!0;break}if(!h){var j=(1===f.size?ay:az)[f.type].replace("location",'ud["'+e+'"].location');d.push('\n            cu = ud["'+e+'"];\n            cv = cu.value;\n            v = uv["'+e+'"];\n            '+j+";")}}return Function("ud","uv","renderer","syncData",d.join("\n"))}(a,this.shader.program.uniformData)),a.syncUniforms[this.shader.program.id]=this.cache[b],a.syncUniforms[this.shader.program.id]},a.prototype.syncUniformBufferGroup=function(a,b){var c=this.getGlProgram();if(!a.static||0!==a.dirtyId||!c.uniformGroups[a.id]){a.dirtyId=0;var d=c.uniformGroups[a.id]||this.createSyncBufferGroup(a,c,b);a.buffer.update(),d(c.uniformData,a.uniforms,this.renderer,aZ,a.buffer)}this.renderer.buffer.bindBufferBase(a.buffer,c.uniformBufferBindings[b])},a.prototype.createSyncBufferGroup=function(a,b,c){var d=this.renderer.gl;this.renderer.buffer.bind(a.buffer);var e=this.gl.getUniformBlockIndex(b.program,c);b.uniformBufferBindings[c]=this.shader.uniformBindCount,d.uniformBlockBinding(b.program,e,this.shader.uniformBindCount),this.shader.uniformBindCount++;var f=this.getSignature(a,this.shader.program.uniformData,"ubo"),g=this._uboCache[f];if(g||(g=this._uboCache[f]=function(a,b){if(!a.autoManage)return{size:0,syncFunc:aU};for(var c=function(a){for(var b=a.map(function(a){return{data:a,offset:0,dataLen:0,dirty:0}}),c=0,d=0,e=0,f=0;f<b.length;f++){var g=b[f];if(c=aW[g.data.type],g.data.size>1&&(c=Math.max(c,16)*g.data.size),g.dataLen=c,d%c!=0&&d<16){var h=d%c%16;d+=h,e+=h}d+c>16?(e=16*Math.ceil(e/16),g.offset=e,e+=c,d=c):(g.offset=e,d+=c,e+=c)}return{uboElements:b,size:e=16*Math.ceil(e/16)}}(function(a,b){var c=[];for(var d in a)b[d]&&c.push(b[d]);return c.sort(function(a,b){return a.index-b.index}),c}(a.uniforms,b)),d=c.uboElements,e=c.size,f=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],g=0;g<d.length;g++){for(var h=d[g],i=a.uniforms[h.data.name],j=h.data.name,k=!1,l=0;l<ax.length;l++){var m=ax[l];if(m.codeUbo&&m.test(h.data,i)){f.push("offset = "+h.offset/4+";",ax[l].codeUbo(h.data.name,i)),k=!0;break}}if(!k){if(h.data.size>1){var n,o=at[n=h.data.type],p=Math.max(aW[h.data.type]/16,1),q=o/p,r=(4-q%4)%4;f.push("\n                cv = ud."+j+".value;\n                v = uv."+j+";\n                offset = "+h.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+h.data.size*p+"; i++)\n                {\n                    for(var j = 0; j < "+q+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+r+";\n                }\n\n                ")}else{var s=aV[h.data.type];f.push("\n                cv = ud."+j+".value;\n                v = uv."+j+";\n                offset = "+h.offset/4+";\n                "+s+";\n                ")}}}return f.push("\n       renderer.buffer.update(buffer);\n    "),{size:e,syncFunc:Function("ud","uv","renderer","syncData","buffer",f.join("\n"))}}(a,this.shader.program.uniformData)),a.autoManage){var h=new Float32Array(g.size/4);a.buffer.update(h)}return b.uniformGroups[a.id]=g.syncFunc,b.uniformGroups[a.id]},a.prototype.getSignature=function(a,b,c){var d=a.uniforms,e=[c+"-"];for(var f in d)e.push(f),b[f]&&e.push(b[f].type);return e.join("-")},a.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},a.prototype.generateProgram=function(a){var b=this.gl,c=a.program,d=function(a,b){var c,d,e,f,g=am(a,a.VERTEX_SHADER,b.vertexSrc),h=am(a,a.FRAGMENT_SHADER,b.fragmentSrc),i=a.createProgram();if(a.attachShader(i,g),a.attachShader(i,h),a.linkProgram(i),!a.getProgramParameter(i,a.LINK_STATUS)&&(c=a,d=i,e=g,f=h,c.getProgramParameter(d,c.LINK_STATUS)||(c.getShaderParameter(e,c.COMPILE_STATUS)||an(c,e),c.getShaderParameter(f,c.COMPILE_STATUS)||an(c,f),console.error("PixiJS Error: Could not initialize shader."),""!==c.getProgramInfoLog(d)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",c.getProgramInfoLog(d)))),b.attributeData=function(a,b){for(var c={},d=b.getProgramParameter(a,b.ACTIVE_ATTRIBUTES),e=0;e<d;e++){var f=b.getActiveAttrib(a,e);if(0!==f.name.indexOf("gl_")){var g,h=aw(b,f.type),i={type:h,name:f.name,size:at[g=h],location:b.getAttribLocation(a,f.name)};c[f.name]=i}}return c}(i,a),b.uniformData=function(a,b){for(var c={},d=b.getProgramParameter(a,b.ACTIVE_UNIFORMS),e=0;e<d;e++){var f=b.getActiveUniform(a,e),g=f.name.replace(/\[.*?\]$/,""),h=!!f.name.match(/\[.*?\]$/),i=aw(b,f.type);c[g]={name:g,index:e,type:i,size:f.size,isArray:h,value:ap(i,f.size)}}return c}(i,a),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(b.vertexSrc)){var j=Object.keys(b.attributeData);j.sort(function(a,b){return a>b?1:-1});for(var k=0;k<j.length;k++)b.attributeData[j[k]].location=k,a.bindAttribLocation(i,k,j[k]);a.linkProgram(i)}a.deleteShader(g),a.deleteShader(h);var l={};for(var k in b.uniformData){var m=b.uniformData[k];l[k]={location:a.getUniformLocation(i,k),value:ap(m.type,m.size)}}return new aX(i,l)}(b,c);return c.glPrograms[this.renderer.CONTEXT_UID]=d,d},a.prototype.reset=function(){this.program=null,this.shader=null},a.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},a}(),a_=function(){function a(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=g.T$.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new aF,this.defaultState.blend=!0}return a.prototype.contextChange=function(a){var b,c;this.gl=a,this.blendModes=(b=a,void 0===c&&(c=[]),c[g.T$.NORMAL]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.ADD]=[b.ONE,b.ONE],c[g.T$.MULTIPLY]=[b.DST_COLOR,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.SCREEN]=[b.ONE,b.ONE_MINUS_SRC_COLOR,b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.OVERLAY]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.DARKEN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.LIGHTEN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.COLOR_DODGE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.COLOR_BURN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.HARD_LIGHT]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.SOFT_LIGHT]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.DIFFERENCE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.EXCLUSION]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.HUE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.SATURATION]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.COLOR]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.LUMINOSITY]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.NONE]=[0,0],c[g.T$.NORMAL_NPM]=[b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.ADD_NPM]=[b.SRC_ALPHA,b.ONE,b.ONE,b.ONE],c[g.T$.SCREEN_NPM]=[b.SRC_ALPHA,b.ONE_MINUS_SRC_COLOR,b.ONE,b.ONE_MINUS_SRC_ALPHA],c[g.T$.SRC_IN]=[b.DST_ALPHA,b.ZERO],c[g.T$.SRC_OUT]=[b.ONE_MINUS_DST_ALPHA,b.ZERO],c[g.T$.SRC_ATOP]=[b.DST_ALPHA,b.ONE_MINUS_SRC_ALPHA],c[g.T$.DST_OVER]=[b.ONE_MINUS_DST_ALPHA,b.ONE],c[g.T$.DST_IN]=[b.ZERO,b.SRC_ALPHA],c[g.T$.DST_OUT]=[b.ZERO,b.ONE_MINUS_SRC_ALPHA],c[g.T$.DST_ATOP]=[b.ONE_MINUS_DST_ALPHA,b.SRC_ALPHA],c[g.T$.XOR]=[b.ONE_MINUS_DST_ALPHA,b.ONE_MINUS_SRC_ALPHA],c[g.T$.SUBTRACT]=[b.ONE,b.ONE,b.ONE,b.ONE,b.FUNC_REVERSE_SUBTRACT,b.FUNC_ADD],c),this.set(this.defaultState),this.reset()},a.prototype.set=function(a){if(a=a||this.defaultState,this.stateId!==a.data){for(var b=this.stateId^a.data,c=0;b;)1&b&&this.map[c].call(this,!!(a.data&1<<c)),b>>=1,c++;this.stateId=a.data}for(var c=0;c<this.checks.length;c++)this.checks[c](this,a)},a.prototype.forceState=function(a){a=a||this.defaultState;for(var b=0;b<this.map.length;b++)this.map[b].call(this,!!(a.data&1<<b));for(var b=0;b<this.checks.length;b++)this.checks[b](this,a);this.stateId=a.data},a.prototype.setBlend=function(b){this.updateCheck(a.checkBlendMode,b),this.gl[b?"enable":"disable"](this.gl.BLEND)},a.prototype.setOffset=function(b){this.updateCheck(a.checkPolygonOffset,b),this.gl[b?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},a.prototype.setDepthTest=function(a){this.gl[a?"enable":"disable"](this.gl.DEPTH_TEST)},a.prototype.setDepthMask=function(a){this.gl.depthMask(a)},a.prototype.setCullFace=function(a){this.gl[a?"enable":"disable"](this.gl.CULL_FACE)},a.prototype.setFrontFace=function(a){this.gl.frontFace(this.gl[a?"CW":"CCW"])},a.prototype.setBlendMode=function(a){if(a!==this.blendMode){this.blendMode=a;var b=this.blendModes[a],c=this.gl;2===b.length?c.blendFunc(b[0],b[1]):c.blendFuncSeparate(b[0],b[1],b[2],b[3]),6===b.length?(this._blendEq=!0,c.blendEquationSeparate(b[4],b[5])):this._blendEq&&(this._blendEq=!1,c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD))}},a.prototype.setPolygonOffset=function(a,b){this.gl.polygonOffset(a,b)},a.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},a.prototype.updateCheck=function(a,b){var c=this.checks.indexOf(a);b&& -1===c?this.checks.push(a):b|| -1===c||this.checks.splice(c,1)},a.checkBlendMode=function(a,b){a.setBlendMode(b.blendMode)},a.checkPolygonOffset=function(a,b){a.setPolygonOffset(1,b.polygonOffset)},a.prototype.destroy=function(){this.gl=null},a}(),a0=function(){function a(a){this.renderer=a,this.count=0,this.checkCount=0,this.maxIdle=f.Xd.GC_MAX_IDLE,this.checkCountMax=f.Xd.GC_MAX_CHECK_COUNT,this.mode=f.Xd.GC_MODE}return a.prototype.postrender=function(){if(this.renderer.renderingToScreen)this.count++,this.mode!==g.UN.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},a.prototype.run=function(){for(var a=this.renderer.texture,b=a.managedTextures,c=!1,d=0;d<b.length;d++){var e=b[d];!e.framebuffer&&this.count-e.touched>this.maxIdle&&(a.destroyTexture(e,!0),b[d]=null,c=!0)}if(c){for(var f=0,d=0;d<b.length;d++)null!==b[d]&&(b[f++]=b[d]);b.length=f}},a.prototype.unload=function(a){var b=this.renderer.texture,c=a._texture;c&&!c.framebuffer&&b.destroyTexture(c);for(var d=a.children.length-1;d>=0;d--)this.unload(a.children[d])},a.prototype.destroy=function(){this.renderer=null},a}(),a1=function(a){this.texture=a,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=g.vK.UNSIGNED_BYTE,this.internalFormat=g.I2.RGBA,this.samplerType=0},a2=function(){function a(a){this.renderer=a,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new u,this.hasIntegerTextures=!1}return a.prototype.contextChange=function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=(a=z,"WebGL2RenderingContext"in globalThis&&a instanceof globalThis.WebGL2RenderingContext?((b={})[g.vK.UNSIGNED_BYTE]=((c={})[g.I2.RGBA]=a.RGBA8,c[g.I2.RGB]=a.RGB8,c[g.I2.RG]=a.RG8,c[g.I2.RED]=a.R8,c[g.I2.RGBA_INTEGER]=a.RGBA8UI,c[g.I2.RGB_INTEGER]=a.RGB8UI,c[g.I2.RG_INTEGER]=a.RG8UI,c[g.I2.RED_INTEGER]=a.R8UI,c[g.I2.ALPHA]=a.ALPHA,c[g.I2.LUMINANCE]=a.LUMINANCE,c[g.I2.LUMINANCE_ALPHA]=a.LUMINANCE_ALPHA,c),b[g.vK.BYTE]=((d={})[g.I2.RGBA]=a.RGBA8_SNORM,d[g.I2.RGB]=a.RGB8_SNORM,d[g.I2.RG]=a.RG8_SNORM,d[g.I2.RED]=a.R8_SNORM,d[g.I2.RGBA_INTEGER]=a.RGBA8I,d[g.I2.RGB_INTEGER]=a.RGB8I,d[g.I2.RG_INTEGER]=a.RG8I,d[g.I2.RED_INTEGER]=a.R8I,d),b[g.vK.UNSIGNED_SHORT]=((e={})[g.I2.RGBA_INTEGER]=a.RGBA16UI,e[g.I2.RGB_INTEGER]=a.RGB16UI,e[g.I2.RG_INTEGER]=a.RG16UI,e[g.I2.RED_INTEGER]=a.R16UI,e[g.I2.DEPTH_COMPONENT]=a.DEPTH_COMPONENT16,e),b[g.vK.SHORT]=((f={})[g.I2.RGBA_INTEGER]=a.RGBA16I,f[g.I2.RGB_INTEGER]=a.RGB16I,f[g.I2.RG_INTEGER]=a.RG16I,f[g.I2.RED_INTEGER]=a.R16I,f),b[g.vK.UNSIGNED_INT]=((h={})[g.I2.RGBA_INTEGER]=a.RGBA32UI,h[g.I2.RGB_INTEGER]=a.RGB32UI,h[g.I2.RG_INTEGER]=a.RG32UI,h[g.I2.RED_INTEGER]=a.R32UI,h[g.I2.DEPTH_COMPONENT]=a.DEPTH_COMPONENT24,h),b[g.vK.INT]=((i={})[g.I2.RGBA_INTEGER]=a.RGBA32I,i[g.I2.RGB_INTEGER]=a.RGB32I,i[g.I2.RG_INTEGER]=a.RG32I,i[g.I2.RED_INTEGER]=a.R32I,i),b[g.vK.FLOAT]=((j={})[g.I2.RGBA]=a.RGBA32F,j[g.I2.RGB]=a.RGB32F,j[g.I2.RG]=a.RG32F,j[g.I2.RED]=a.R32F,j[g.I2.DEPTH_COMPONENT]=a.DEPTH_COMPONENT32F,j),b[g.vK.HALF_FLOAT]=((k={})[g.I2.RGBA]=a.RGBA16F,k[g.I2.RGB]=a.RGB16F,k[g.I2.RG]=a.RG16F,k[g.I2.RED]=a.R16F,k),b[g.vK.UNSIGNED_SHORT_5_6_5]=((l={})[g.I2.RGB]=a.RGB565,l),b[g.vK.UNSIGNED_SHORT_4_4_4_4]=((m={})[g.I2.RGBA]=a.RGBA4,m),b[g.vK.UNSIGNED_SHORT_5_5_5_1]=((n={})[g.I2.RGBA]=a.RGB5_A1,n),b[g.vK.UNSIGNED_INT_2_10_10_10_REV]=((o={})[g.I2.RGBA]=a.RGB10_A2,o[g.I2.RGBA_INTEGER]=a.RGB10_A2UI,o),b[g.vK.UNSIGNED_INT_10F_11F_11F_REV]=((p={})[g.I2.RGB]=a.R11F_G11F_B10F,p),b[g.vK.UNSIGNED_INT_5_9_9_9_REV]=((q={})[g.I2.RGB]=a.RGB9_E5,q),b[g.vK.UNSIGNED_INT_24_8]=((r={})[g.I2.DEPTH_STENCIL]=a.DEPTH24_STENCIL8,r),b[g.vK.FLOAT_32_UNSIGNED_INT_24_8_REV]=((s={})[g.I2.DEPTH_STENCIL]=a.DEPTH32F_STENCIL8,s),b):((t={})[g.vK.UNSIGNED_BYTE]=((u={})[g.I2.RGBA]=a.RGBA,u[g.I2.RGB]=a.RGB,u[g.I2.ALPHA]=a.ALPHA,u[g.I2.LUMINANCE]=a.LUMINANCE,u[g.I2.LUMINANCE_ALPHA]=a.LUMINANCE_ALPHA,u),t[g.vK.UNSIGNED_SHORT_5_6_5]=((v={})[g.I2.RGB]=a.RGB,v),t[g.vK.UNSIGNED_SHORT_4_4_4_4]=((w={})[g.I2.RGBA]=a.RGBA,w),t[g.vK.UNSIGNED_SHORT_5_5_5_1]=((x={})[g.I2.RGBA]=a.RGBA,x),t));var A=z.getParameter(z.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=A;for(var B=0;B<A;B++)this.boundTextures[B]=null;this.emptyTextures={};var C=new a1(z.createTexture());z.bindTexture(z.TEXTURE_2D,C.texture),z.texImage2D(z.TEXTURE_2D,0,z.RGBA,1,1,0,z.RGBA,z.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[z.TEXTURE_2D]=C,this.emptyTextures[z.TEXTURE_CUBE_MAP]=new a1(z.createTexture()),z.bindTexture(z.TEXTURE_CUBE_MAP,this.emptyTextures[z.TEXTURE_CUBE_MAP].texture);for(var B=0;B<6;B++)z.texImage2D(z.TEXTURE_CUBE_MAP_POSITIVE_X+B,0,z.RGBA,1,1,0,z.RGBA,z.UNSIGNED_BYTE,null);z.texParameteri(z.TEXTURE_CUBE_MAP,z.TEXTURE_MAG_FILTER,z.LINEAR),z.texParameteri(z.TEXTURE_CUBE_MAP,z.TEXTURE_MIN_FILTER,z.LINEAR);for(var B=0;B<this.boundTextures.length;B++)this.bind(null,B)},a.prototype.bind=function(a,b){void 0===b&&(b=0);var c=this.gl;if((a=null==a?void 0:a.castToBaseTexture())&&a.valid&&!a.parentTextureArray){a.touched=this.renderer.textureGC.count;var d=a._glTextures[this.CONTEXT_UID]||this.initTexture(a);this.boundTextures[b]!==a&&(this.currentLocation!==b&&(this.currentLocation=b,c.activeTexture(c.TEXTURE0+b)),c.bindTexture(a.target,d.texture)),d.dirtyId!==a.dirtyId&&(this.currentLocation!==b&&(this.currentLocation=b,c.activeTexture(c.TEXTURE0+b)),this.updateTexture(a)),this.boundTextures[b]=a}else this.currentLocation!==b&&(this.currentLocation=b,c.activeTexture(c.TEXTURE0+b)),c.bindTexture(c.TEXTURE_2D,this.emptyTextures[c.TEXTURE_2D].texture),this.boundTextures[b]=null},a.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var a=0;a<this.boundTextures.length;a++)this.boundTextures[a]=this.unknownTexture},a.prototype.unbind=function(a){var b=this.gl,c=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var d=0;d<c.length;d++)c[d]===this.unknownTexture&&this.bind(null,d)}for(var d=0;d<c.length;d++)c[d]===a&&(this.currentLocation!==d&&(b.activeTexture(b.TEXTURE0+d),this.currentLocation=d),b.bindTexture(a.target,this.emptyTextures[a.target].texture),c[d]=null)},a.prototype.ensureSamplerType=function(a){var b=this.boundTextures,c=this.hasIntegerTextures,d=this.CONTEXT_UID;if(c)for(var e=a-1;e>=0;--e){var f=b[e];f&&f._glTextures[d].samplerType!==g.oT.FLOAT&&this.renderer.texture.unbind(f)}},a.prototype.initTexture=function(a){var b=new a1(this.gl.createTexture());return b.dirtyId=-1,a._glTextures[this.CONTEXT_UID]=b,this.managedTextures.push(a),a.on("dispose",this.destroyTexture,this),b},a.prototype.initTextureType=function(a,b){var c,d;b.internalFormat=null!==(d=null===(c=this.internalFormats[a.type])|| void 0===c?void 0:c[a.format])&& void 0!==d?d:a.format,2===this.webGLVersion&&a.type===g.vK.HALF_FLOAT?b.type=this.gl.HALF_FLOAT:b.type=a.type},a.prototype.updateTexture=function(a){var b=a._glTextures[this.CONTEXT_UID];if(b){var c=this.renderer;if(this.initTextureType(a,b),a.resource&&a.resource.upload(c,a,b))b.samplerType!==g.oT.FLOAT&&(this.hasIntegerTextures=!0);else{var d=a.realWidth,e=a.realHeight,f=c.gl;(b.width!==d||b.height!==e||b.dirtyId<0)&&(b.width=d,b.height=e,f.texImage2D(a.target,0,b.internalFormat,d,e,0,a.format,b.type,null))}a.dirtyStyleId!==b.dirtyStyleId&&this.updateTextureStyle(a),b.dirtyId=a.dirtyId}},a.prototype.destroyTexture=function(a,b){var c=this.gl;if((a=a.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(a),c.deleteTexture(a._glTextures[this.CONTEXT_UID].texture),a.off("dispose",this.destroyTexture,this),delete a._glTextures[this.CONTEXT_UID],!b)){var d=this.managedTextures.indexOf(a);-1!==d&&(0,h.removeItems)(this.managedTextures,d,1)}},a.prototype.updateTextureStyle=function(a){var b=a._glTextures[this.CONTEXT_UID];b&&(a.mipmap!==g.WB.POW2&&2===this.webGLVersion||a.isPowerOfTwo?b.mipmap=a.mipmap>=1:b.mipmap=!1,2===this.webGLVersion||a.isPowerOfTwo?b.wrapMode=a.wrapMode:b.wrapMode=g.Nt.CLAMP,a.resource&&a.resource.style(this.renderer,a,b)||this.setStyle(a,b),b.dirtyStyleId=a.dirtyStyleId)},a.prototype.setStyle=function(a,b){var c=this.gl;if(b.mipmap&&a.mipmap!==g.WB.ON_MANUAL&&c.generateMipmap(a.target),c.texParameteri(a.target,c.TEXTURE_WRAP_S,b.wrapMode),c.texParameteri(a.target,c.TEXTURE_WRAP_T,b.wrapMode),b.mipmap){c.texParameteri(a.target,c.TEXTURE_MIN_FILTER,a.scaleMode===g.aH.LINEAR?c.LINEAR_MIPMAP_LINEAR:c.NEAREST_MIPMAP_NEAREST);var d=this.renderer.context.extensions.anisotropicFiltering;if(d&&a.anisotropicLevel>0&&a.scaleMode===g.aH.LINEAR){var e=Math.min(a.anisotropicLevel,c.getParameter(d.MAX_TEXTURE_MAX_ANISOTROPY_EXT));c.texParameterf(a.target,d.TEXTURE_MAX_ANISOTROPY_EXT,e)}}else c.texParameteri(a.target,c.TEXTURE_MIN_FILTER,a.scaleMode===g.aH.LINEAR?c.LINEAR:c.NEAREST);c.texParameteri(a.target,c.TEXTURE_MAG_FILTER,a.scaleMode===g.aH.LINEAR?c.LINEAR:c.NEAREST)},a.prototype.destroy=function(){this.renderer=null},a}(),a3={__proto__:null,FilterSystem:ab,BatchSystem:ad,ContextSystem:af,FramebufferSystem:ai,GeometrySystem:ak,MaskSystem:aK,ScissorSystem:aO,StencilSystem:aP,ProjectionSystem:aQ,RenderTextureSystem:aT,ShaderSystem:a$,StateSystem:a_,TextureGCSystem:a0,TextureSystem:a2},a4=new l.y3,a5=function(a){function b(b,c){void 0===b&&(b=g.N3.UNKNOWN);var d=a.call(this)||this;return c=Object.assign({},f.Xd.RENDER_OPTIONS,c),d.options=c,d.type=b,d.screen=new l.Ae(0,0,c.width,c.height),d.view=c.view||f.Xd.ADAPTER.createCanvas(),d.resolution=c.resolution||f.Xd.RESOLUTION,d.useContextAlpha=c.useContextAlpha,d.autoDensity=!!c.autoDensity,d.preserveDrawingBuffer=c.preserveDrawingBuffer,d.clearBeforeRender=c.clearBeforeRender,d._backgroundColor=0,d._backgroundColorRgba=[0,0,0,1],d._backgroundColorString="#000000",d.backgroundColor=c.backgroundColor||d._backgroundColor,d.backgroundAlpha=c.backgroundAlpha,void 0!==c.transparent&&((0,h.deprecation)("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),d.useContextAlpha=c.transparent,d.backgroundAlpha=c.transparent?0:1),d._lastObjectRendered=null,d.plugins={},d}return p(b,a),b.prototype.initPlugins=function(a){for(var b in a)this.plugins[b]=new a[b](this)},Object.defineProperty(b.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),b.prototype.resize=function(a,b){this.view.width=Math.round(a*this.resolution),this.view.height=Math.round(b*this.resolution);var c=this.view.width/this.resolution,d=this.view.height/this.resolution;this.screen.width=c,this.screen.height=d,this.autoDensity&&(this.view.style.width=c+"px",this.view.style.height=d+"px"),this.emit("resize",c,d)},b.prototype.generateTexture=function(a,b,c,d){void 0===b&&(b={}),"number"==typeof b&&((0,h.deprecation)("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),b={scaleMode:b,resolution:c,region:d});var e=b.region,f=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}(b,["region"]);0===(d=e||a.getLocalBounds(null,!0)).width&&(d.width=1),0===d.height&&(d.height=1);var g=M.create(q({width:d.width,height:d.height},f));return a4.tx=-d.x,a4.ty=-d.y,this.render(a,{renderTexture:g,clear:!1,transform:a4,skipUpdateTransform:!!a.parent}),g},b.prototype.destroy=function(a){for(var b in this.plugins)this.plugins[b].destroy(),this.plugins[b]=null;a&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var c=this;c.plugins=null,c.type=g.N3.UNKNOWN,c.view=null,c.screen=null,c._tempDisplayObjectParent=null,c.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(b.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a,this._backgroundColorString=(0,h.hex2string)(a),(0,h.hex2rgb)(a,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(a){this._backgroundColorRgba[3]=a},enumerable:!1,configurable:!0}),b}(h.EventEmitter),a6=function(a){this.buffer=a||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},a7=function(){function a(a){this.renderer=a,this.managedBuffers={},this.boundBufferBases={}}return a.prototype.destroy=function(){this.renderer=null},a.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},a.prototype.bind=function(a){var b=this.gl,c=this.CONTEXT_UID,d=a._glBuffers[c]||this.createGLBuffer(a);b.bindBuffer(a.type,d.buffer)},a.prototype.bindBufferBase=function(a,b){var c=this.gl,d=this.CONTEXT_UID;if(this.boundBufferBases[b]!==a){var e=a._glBuffers[d]||this.createGLBuffer(a);this.boundBufferBases[b]=a,c.bindBufferBase(c.UNIFORM_BUFFER,b,e.buffer)}},a.prototype.bindBufferRange=function(a,b,c){var d=this.gl,e=this.CONTEXT_UID;c=c||0;var f=a._glBuffers[e]||this.createGLBuffer(a);d.bindBufferRange(d.UNIFORM_BUFFER,b||0,f.buffer,256*c,256)},a.prototype.update=function(a){var b=this.gl,c=this.CONTEXT_UID,d=a._glBuffers[c];if(a._updateID!==d.updateID){if(d.updateID=a._updateID,b.bindBuffer(a.type,d.buffer),d.byteLength>=a.data.byteLength)b.bufferSubData(a.type,0,a.data);else{var e=a.static?b.STATIC_DRAW:b.DYNAMIC_DRAW;d.byteLength=a.data.byteLength,b.bufferData(a.type,a.data,e)}}},a.prototype.dispose=function(a,b){if(this.managedBuffers[a.id]){delete this.managedBuffers[a.id];var c=a._glBuffers[this.CONTEXT_UID],d=this.gl;a.disposeRunner.remove(this),c&&(b||d.deleteBuffer(c.buffer),delete a._glBuffers[this.CONTEXT_UID])}},a.prototype.disposeAll=function(a){for(var b=Object.keys(this.managedBuffers),c=0;c<b.length;c++)this.dispose(this.managedBuffers[b[c]],a)},a.prototype.createGLBuffer=function(a){var b=this.CONTEXT_UID,c=this.gl;return a._glBuffers[b]=new a6(c.createBuffer()),this.managedBuffers[a.id]=a,a.disposeRunner.add(this),a._glBuffers[b]},a}(),a8=function(a){function b(c){var d=a.call(this,g.N3.WEBGL,c)||this;return c=d.options,d.gl=null,d.CONTEXT_UID=0,d.runners={destroy:new j.R("destroy"),contextChange:new j.R("contextChange"),reset:new j.R("reset"),update:new j.R("update"),postrender:new j.R("postrender"),prerender:new j.R("prerender"),resize:new j.R("resize")},d.runners.contextChange.add(d),d.globalUniforms=new Z({projectionMatrix:new l.y3},!0),d.addSystem(aK,"mask").addSystem(af,"context").addSystem(a_,"state").addSystem(a$,"shader").addSystem(a2,"texture").addSystem(a7,"buffer").addSystem(ak,"geometry").addSystem(ai,"framebuffer").addSystem(aO,"scissor").addSystem(aP,"stencil").addSystem(aQ,"projection").addSystem(a0,"textureGC").addSystem(ab,"filter").addSystem(aT,"renderTexture").addSystem(ad,"batch"),d.initPlugins(b.__plugins),d.multisample=void 0,c.context?d.context.initFromContext(c.context):d.context.initFromOptions({alpha:!!d.useContextAlpha,antialias:c.antialias,premultipliedAlpha:d.useContextAlpha&&"notMultiplied"!==d.useContextAlpha,stencil:!0,preserveDrawingBuffer:c.preserveDrawingBuffer,powerPreference:d.options.powerPreference}),d.renderingToScreen=!0,(0,h.sayHello)(2===d.context.webGLVersion?"WebGL 2":"WebGL 1"),d.resize(d.options.width,d.options.height),d}return p(b,a),b.create=function(a){if((0,h.isWebGLSupported)())return new b(a);throw Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},b.prototype.contextChange=function(){var a,b=this.gl;if(1===this.context.webGLVersion){var c=b.getParameter(b.FRAMEBUFFER_BINDING);b.bindFramebuffer(b.FRAMEBUFFER,null),a=b.getParameter(b.SAMPLES),b.bindFramebuffer(b.FRAMEBUFFER,c)}else{var c=b.getParameter(b.DRAW_FRAMEBUFFER_BINDING);b.bindFramebuffer(b.DRAW_FRAMEBUFFER,null),a=b.getParameter(b.SAMPLES),b.bindFramebuffer(b.DRAW_FRAMEBUFFER,c)}a>=g.G5.HIGH?this.multisample=g.G5.HIGH:a>=g.G5.MEDIUM?this.multisample=g.G5.MEDIUM:a>=g.G5.LOW?this.multisample=g.G5.LOW:this.multisample=g.G5.NONE},b.prototype.addSystem=function(a,b){var c=new a(this);if(this[b])throw Error('Whoops! The name "'+b+'" is already in use');for(var d in this[b]=c,this.runners)this.runners[d].add(c);return this},b.prototype.render=function(a,b){if(b&&(b instanceof M?((0,h.deprecation)("6.0.0","Renderer#render arguments changed, use options instead."),c=b,d=arguments[2],e=arguments[3],f=arguments[4]):(c=b.renderTexture,d=b.clear,e=b.transform,f=b.skipUpdateTransform)),this.renderingToScreen=!c,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=e,!this.context.isLost){if(c||(this._lastObjectRendered=a),!f){var c,d,e,f,g=a.enableTempParent();a.updateTransform(),a.disableTempParent(g)}this.renderTexture.bind(c),this.batch.currentRenderer.start(),(void 0!==d?d:this.clearBeforeRender)&&this.renderTexture.clear(),a.render(this),this.batch.currentRenderer.flush(),c&&c.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},b.prototype.generateTexture=function(b,c,d,e){void 0===c&&(c={});var f=a.prototype.generateTexture.call(this,b,c,d,e);return this.framebuffer.blit(),f},b.prototype.resize=function(b,c){a.prototype.resize.call(this,b,c),this.runners.resize.emit(this.screen.height,this.screen.width)},b.prototype.reset=function(){return this.runners.reset.emit(),this},b.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},b.prototype.destroy=function(b){for(var c in this.runners.destroy.emit(),this.runners)this.runners[c].destroy();a.prototype.destroy.call(this,b),this.gl=null},Object.defineProperty(b.prototype,"extract",{get:function(){return(0,h.deprecation)("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),b.registerPlugin=function(a,b){(0,h.deprecation)("6.5.0","Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),i.R.add({name:a,type:i.n.RendererPlugin,ref:b})},b.__plugins={},b}(a5);function a9(a){return a8.create(a)}i.R.handleByMap(i.n.RendererPlugin,a8.__plugins);var ba="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",bb="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";(function a(b){(0,h.deprecation)("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=b}).prototype.destroy=function(){this.renderer=null};var bc=function(){this.texArray=null,this.blend=0,this.type=g.lg.TRIANGLES,this.start=0,this.size=0,this.data=null},bd=function(){function a(){this.elements=[],this.ids=[],this.count=0}return a.prototype.clear=function(){for(var a=0;a<this.count;a++)this.elements[a]=null;this.count=0},a}(),be=function(){function a(a){"number"==typeof a?this.rawBinaryData=new ArrayBuffer(a):a instanceof Uint8Array?this.rawBinaryData=a.buffer:this.rawBinaryData=a,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(a.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),a.prototype.view=function(a){return this[a+"View"]},a.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},a.sizeOf=function(a){switch(a){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw Error(a+" isn't a valid view type")}},a}(),bf=function(a){function b(b){var c=a.call(this,b)||this;return c.shaderGenerator=null,c.geometryClass=null,c.vertexSize=null,c.state=aF.for2d(),c.size=4*f.Xd.SPRITE_BATCH_SIZE,c._vertexCount=0,c._indexCount=0,c._bufferedElements=[],c._bufferedTextures=[],c._bufferSize=0,c._shader=null,c._packedGeometries=[],c._packedGeometryPoolSize=2,c._flushId=0,c._aBuffers={},c._iBuffers={},c.MAX_TEXTURES=1,c.renderer.on("prerender",c.onPrerender,c),b.runners.contextChange.add(c),c._dcIndex=0,c._aIndex=0,c._iIndex=0,c._attributeBuffer=null,c._indexBuffer=null,c._tempBoundTextures=[],c}return p(b,a),b.prototype.contextChange=function(){var a=this.renderer.gl;f.Xd.PREFER_ENV===g.Vi.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),f.Xd.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(a,b){if(0===a)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var c=b.createShader(b.FRAGMENT_SHADER);;){var d="precision mediump float;\nvoid main(void){\nfloat test = 0.1;\n%forloop%\ngl_FragColor = vec4(0.0);\n}".replace(/%forloop%/gi,aA(a));if(b.shaderSource(c,d),b.compileShader(c),b.getShaderParameter(c,b.COMPILE_STATUS))break;a=a/2|0}return a}(this.MAX_TEXTURES,a)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var b=0;b<this._packedGeometryPoolSize;b++)this._packedGeometries[b]=new this.geometryClass;this.initFlushBuffers()},b.prototype.initFlushBuffers=function(){for(var a=b._drawCallPool,c=b._textureArrayPool,d=this.size/4,e=Math.floor(d/this.MAX_TEXTURES)+1;a.length<d;)a.push(new bc);for(;c.length<e;)c.push(new bd);for(var f=0;f<this.MAX_TEXTURES;f++)this._tempBoundTextures[f]=null},b.prototype.onPrerender=function(){this._flushId=0},b.prototype.render=function(a){a._texture.valid&&(this._vertexCount+a.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=a.vertexData.length/2,this._indexCount+=a.indices.length,this._bufferedTextures[this._bufferSize]=a._texture.baseTexture,this._bufferedElements[this._bufferSize++]=a)},b.prototype.buildTexturesAndDrawCalls=function(){var a=this,c=a._bufferedTextures,d=a.MAX_TEXTURES,e=b._textureArrayPool,f=this.renderer.batch,g=this._tempBoundTextures,h=this.renderer.textureGC.count,i=++u._globalBatch,j=0,k=e[0],l=0;f.copyBoundTextures(g,d);for(var m=0;m<this._bufferSize;++m){var n=c[m];c[m]=null,n._batchEnabled!==i&&(k.count>=d&&(f.boundArray(k,g,i,d),this.buildDrawCalls(k,l,m),l=m,k=e[++j],++i),n._batchEnabled=i,n.touched=h,k.elements[k.count++]=n)}k.count>0&&(f.boundArray(k,g,i,d),this.buildDrawCalls(k,l,this._bufferSize),++j,++i);for(var m=0;m<g.length;m++)g[m]=null;u._globalBatch=i},b.prototype.buildDrawCalls=function(a,c,d){var e=this._bufferedElements,f=this._attributeBuffer,g=this._indexBuffer,i=this.vertexSize,j=b._drawCallPool,k=this._dcIndex,l=this._aIndex,m=this._iIndex,n=j[k];n.start=this._iIndex,n.texArray=a;for(var o=c;o<d;++o){var p=e[o],q=p._texture.baseTexture,r=h.premultiplyBlendMode[q.alphaMode?1:0][p.blendMode];e[o]=null,c<o&&n.blend!==r&&(n.size=m-n.start,c=o,(n=j[++k]).texArray=a,n.start=m),this.packInterleavedGeometry(p,f,g,l,m),l+=p.vertexData.length/2*i,m+=p.indices.length,n.blend=r}c<d&&(n.size=m-n.start,++k),this._dcIndex=k,this._aIndex=l,this._iIndex=m},b.prototype.bindAndClearTexArray=function(a){for(var b=this.renderer.texture,c=0;c<a.count;c++)b.bind(a.elements[c],a.ids[c]),a.elements[c]=null;a.count=0},b.prototype.updateGeometry=function(){var a=this._packedGeometries,b=this._attributeBuffer,c=this._indexBuffer;f.Xd.CAN_UPLOAD_SAME_BUFFER?(a[this._flushId]._buffer.update(b.rawBinaryData),a[this._flushId]._indexBuffer.update(c),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,a[this._flushId]=new this.geometryClass),a[this._flushId]._buffer.update(b.rawBinaryData),a[this._flushId]._indexBuffer.update(c),this.renderer.geometry.bind(a[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},b.prototype.drawBatches=function(){for(var a=this._dcIndex,c=this.renderer,d=c.gl,e=c.state,f=b._drawCallPool,g=null,h=0;h<a;h++){var i=f[h],j=i.texArray,k=i.type,l=i.size,m=i.start,n=i.blend;g!==j&&(g=j,this.bindAndClearTexArray(j)),this.state.blendMode=n,e.set(this.state),d.drawElements(k,l,d.UNSIGNED_SHORT,2*m)}},b.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},b.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),f.Xd.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},b.prototype.stop=function(){this.flush()},b.prototype.destroy=function(){for(var b=0;b<this._packedGeometryPoolSize;b++)this._packedGeometries[b]&&this._packedGeometries[b].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),a.prototype.destroy.call(this)},b.prototype.getAttributeBuffer=function(a){var b=(0,h.nextPow2)(Math.ceil(a/8)),c=(0,h.log2)(b),d=8*b;this._aBuffers.length<=c&&(this._iBuffers.length=c+1);var e=this._aBuffers[d];return e||(this._aBuffers[d]=e=new be(d*this.vertexSize*4)),e},b.prototype.getIndexBuffer=function(a){var b=(0,h.nextPow2)(Math.ceil(a/12)),c=(0,h.log2)(b);this._iBuffers.length<=c&&(this._iBuffers.length=c+1);var d=this._iBuffers[c];return d||(this._iBuffers[c]=d=new Uint16Array(12*b)),d},b.prototype.packInterleavedGeometry=function(a,b,c,d,e){for(var f=b.uint32View,g=b.float32View,i=d/this.vertexSize,j=a.uvs,k=a.indices,l=a.vertexData,m=a._texture.baseTexture._batchLocation,n=Math.min(a.worldAlpha,1),o=n<1&&a._texture.baseTexture.alphaMode?(0,h.premultiplyTint)(a._tintRGB,n):a._tintRGB+(255*n<<24),p=0;p<l.length;p+=2)g[d++]=l[p],g[d++]=l[p+1],g[d++]=j[p],g[d++]=j[p+1],f[d++]=o,g[d++]=m;for(var p=0;p<k.length;p++)c[e++]=i+k[p]},b._drawCallPool=[],b._textureArrayPool=[],b}(ac),bg=function(){function a(a,b){if(this.vertexSrc=a,this.fragTemplate=b,this.programCache={},this.defaultGroupCache={},0>b.indexOf("%count%"))throw Error('Fragment template must contain "%count%".');if(0>b.indexOf("%forloop%"))throw Error('Fragment template must contain "%forloop%".')}return a.prototype.generateShader=function(a){if(!this.programCache[a]){for(var b=new Int32Array(a),c=0;c<a;c++)b[c]=c;this.defaultGroupCache[a]=Z.from({uSamplers:b},!0);var d=this.fragTemplate;d=(d=d.replace(/%count%/gi,""+a)).replace(/%forloop%/gi,this.generateSampleSrc(a)),this.programCache[a]=new aD(this.vertexSrc,d)}var e={tint:new Float32Array([1,1,1,1]),translationMatrix:new l.y3,default:this.defaultGroupCache[a]};return new aE(this.programCache[a],e)},a.prototype.generateSampleSrc=function(a){var b="";b+="\n",b+="\n";for(var c=0;c<a;c++)c>0&&(b+="\nelse "),c<a-1&&(b+="if(vTextureId < "+c+".5)"),b+="\n{",b+="\n	color = texture2D(uSamplers["+c+"], vTextureCoord);",b+="\n}";return b+="\n",b+="\n"},a}(),bh=function(a){function b(b){void 0===b&&(b=!1);var c=a.call(this)||this;return c._buffer=new Q(null,b,!1),c._indexBuffer=new Q(null,b,!0),c.addAttribute("aVertexPosition",c._buffer,2,!1,g.vK.FLOAT).addAttribute("aTextureCoord",c._buffer,2,!1,g.vK.FLOAT).addAttribute("aColor",c._buffer,4,!0,g.vK.UNSIGNED_BYTE).addAttribute("aTextureId",c._buffer,1,!0,g.vK.FLOAT).addIndex(c._indexBuffer),c}return p(b,a),b}(V),bi="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",bj="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",bk=(function(){function a(){}return a.create=function(a){var b=Object.assign({vertex:bi,fragment:bj,geometryClass:bh,vertexSize:6},a),c=b.vertex,d=b.fragment,e=b.vertexSize,f=b.geometryClass;return function(a){function b(b){var g=a.call(this,b)||this;return g.shaderGenerator=new bg(c,d),g.geometryClass=f,g.vertexSize=e,g}return p(b,a),b}(bf)},Object.defineProperty(a,"defaultVertexSrc",{get:function(){return bi},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultFragmentTemplate",{get:function(){return bj},enumerable:!1,configurable:!0}),a})().create();Object.assign(bk,{extension:{name:"batch",type:i.n.RendererPlugin}});var bl={},bm=function(a){Object.defineProperty(bl,a,{get:function(){return(0,h.deprecation)("6.0.0","PIXI.systems."+a+" has moved to PIXI."+a),E[a]}})};for(var bn in E)bm(bn);var bo={},bp=function(a){Object.defineProperty(bo,a,{get:function(){return(0,h.deprecation)("6.0.0","PIXI.resources."+a+" has moved to PIXI."+a),a3[a]}})};for(var bn in a3)bp(bn)}}])