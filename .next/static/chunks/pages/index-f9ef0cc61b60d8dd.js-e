(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{122:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return F}});var d=c(7812),e=c(9499),f=c(6835),g=c(7294),h=c(4915),i=c(5009),j=c(975),k=c(4923),l=c(9517),m=c(846),n=c(6364),o=c(4742),p=c(585),q=c(5449),r=c(9477),s=c(6008),t=c(5923),u=c(7484),v=c.n(u),w=c(4975),x=c(5893);function y(){for(var a=(0,g.useContext)(p.Z),b=[0],c=4;c<29;++c)b.push(Math.round(Math.pow(10,c/4)));return(0,x.jsx)(j.x,{direction:"row",gap:"2px",justify:"stretch",children:b.map(function(b){return(0,x.jsx)(j.x,{direction:"column",width:"5rem",children:(0,x.jsx)(j.x,{justify:"end",background:a.valueColor(b),width:"100%",height:"2rem",children:(0,x.jsx)(l.x,{textAlign:"center",color:"white",size:"xsmall",children:b})})},b)})})}function z(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function A(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?z(Object(c),!0).forEach(function(b){(0,e.Z)(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):z(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var B=c(9212);v().extend(B);var C=["all","Africa","Europe","Americas","Asia"],D=null;function E(a){var b=a.responsiveness,c=void 0===b?20:b,d=a.children,e=(0,n.w)().size,h=(0,g.useMemo)(function(){return new r.Euler},[]),i=(0,q.useSpring)(function(){return{rotation:[0,0,0]}}),j=(0,f.Z)(i,2),k=j[0],l=j[1],m=(0,s.c0)(function(a){var b=(0,f.Z)(a.delta,2),d=b[0],g=b[1];h.y+=d/e.width*c,h.x+=g/e.width*c,h.x=r.MathUtils.clamp(h.x,-Math.PI/2,Math.PI/2),l({rotation:h.toArray().slice(0,3)})});return(0,x.jsx)(q.a.group,A(A(A({},m()),k),{},{children:d}))}D=c(8977).Z;var F=function(){var a=(0,g.useContext)(p.Z),b=(0,g.useMemo)(function(){return new t.B3({geoJson:null,time:0,continent:"all",animate:!1,animationInterval:.25,globe:null},{selectors:{currentDate:function(a){var b=a.time;return v()(new Date(2020,0,1)).add(b,"d")},resolution:function(a){var b=a.continent;switch(b){case"Europe":return 4;case"Americas":case"Africa":return 3;default:return 2}},features:function(a){var b=a.geoJson,c=a.continent;return b?"all"===c?b:b.filter(function(a){return"RUS"===a.properties.WB_A3?"Asia"===c:"Americas"===c?"North America"===a.properties.CONTINENT||"South America"===a.properties.CONTINENT:"Asia"===c&&"Oceania"===a.properties.CONTINENT||a.properties.CONTINENT===c}):null}},actions:{newContinent:function(a,b){a.do.setContinent(b)},colorFn:function(b,c){var d=c.properties.WB_A3,e="".concat(d,"-deaths"),f=a.base.table("pivots").getData(e);if(!f)return w.E.toString({format:"srgb"});var g=f.offset,h=f.st,i=f.data,j=b.selector("currentDate"),k=v()(h).add(g,"d"),l=j.diff(k,"d");if(l<0)return w.E.toString({format:"srgb"});if(l>=i.length)return a.valueColor(i[i.length-1]);var m=a.valueColor(i[l]);return console.log("coloring ",d,m),m},toggleAnimate:function(a){a.do.setAnimate(!a.value.animate),a.do.setTime(0),a.value.animate&&a.do.next()},next:function(a){if(a.value.animate)!a.selector("currentDate").isSameOrAfter(new Date)&&setTimeout(a.do.advanceTime,a.value.animationInterval)},advanceTime:function(a){a.do.setTime(a.value.time+1),a.do.next()},loadGeoJson:function(b){a.getGeoJson().then(function(a){b.do.setGeoJson(a)})}}})},[]);(0,g.useEffect)(function(){var c=b.subscribe(f);return b.do.loadGeoJson(),console.log("model colors: ",JSON.stringify((0,d.Z)(a.valueColorSet().entries()))),function(){return c.unsubscribe()}},[b]),(0,g.useEffect)(function(){a.getField("deaths")},[]);var c=(0,g.useState)(null),e=c[0],f=c[1],n=e||{},q=n.geoJson,r=n.changing,s=n.continent,u=void 0===s?"all":s,z=n.time,A=n.animate,B=n.$currentDate,F=n.$features,G=n.$resolution,H=(0,g.useMemo)(function(){return D&&b.selector("features")?new D({animateIn:!1}).globeImageUrl("//unpkg.com/three-globe/example/img/earth-dark.jpg").hexPolygonsData(b.selector("features")).hexPolygonResolution(G).hexPolygonMargin(.1).hexPolygonColor(b.do.colorFn):null},[u,q,D,r]);return((0,g.useEffect)(function(){H&&H.hexPolygonsData((0,d.Z)(F))},[z,H,u]),q&&H)?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:(0,x.jsxs)(o.Xz,{children:[(0,x.jsx)("ambientLight",{color:"#cddbfe"}),(0,x.jsx)("directionalLight",{color:"#cddbfe"}),(0,x.jsx)("pointLight",{position:[10,10,10]}),r?null:(0,x.jsx)("mesh",{position:[-20,-5,-180],children:(0,x.jsx)(E,{children:(0,x.jsx)("primitive",{object:H})})})]})}),(0,x.jsx)(i.m,{plain:!0,position:"top-right",modal:!1,fill:"horizontal",children:(0,x.jsxs)(j.x,{style:{zIndex:1e4},align:"baseline",pad:"small",direction:"row-reverse",gap:"medium",fill:"horizontal",children:[(0,x.jsx)(j.x,{background:"#FFF",children:(0,x.jsx)(k.P,{options:C,value:u,valueLabel:function(a){return(0,x.jsx)(j.x,{pad:"2px",fill:"horizontal",background:"#FFF",children:(0,x.jsx)(l.x,{children:a})})},onChange:function(a){var c=a.value;return b.do.newContinent(c)},children:function(a){return(0,x.jsx)(j.x,{pad:"small",fill:"horizontal",background:"#FFF",children:(0,x.jsx)(l.x,{children:a})})}})}),(0,x.jsx)(j.x,{pad:"small",children:(0,x.jsx)(l.x,{color:"white",children:"Continent"})}),(0,x.jsx)(m.z,{color:"black",label:A?"Stop":"Animate",primary:!0,onClick:b.do.toggleAnimate}),A?(0,x.jsxs)(l.x,{children:[B.format("MMM DD YYYY")," "]}):""]})}),(0,x.jsx)(i.m,{plain:!0,position:"bottom-right",modal:!1,children:(0,x.jsx)(y,{})})]}):(0,x.jsx)(h.$,{size:"large"})}},5728:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return c(122)}])}},function(a){a.O(0,[737,246,517,389,762,254,752,444,774,888,179],function(){var b;return a(a.s=5728)}),_N_E=a.O()}])