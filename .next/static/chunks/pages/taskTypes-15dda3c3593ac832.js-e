(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{2203:function(a,b,c){"use strict";var d=c(9499),e=c(9359),f=c(4915),g=c(5170),h=c(5893);function i(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}var j=function(a){var b=a.data,c=a.cols,j=a.tableParams;return b?(0,h.jsx)(e.w,function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?i(Object(c),!0).forEach(function(b){(0,d.Z)(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):i(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}({fill:!0,sort:!0,columns:c,data:b},void 0===j?{}:j)):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f.$,{}),(0,h.jsx)(g.n,{size:"small",children:"Loading..."})]})};b.Z=j},5165:function(a,b,c){"use strict";var d=c(8999),e=c(5591),f=c(846),g=c(7294),h=c(5893),i=function(a){var b=a.children,c=a.id,i=a.onClick,j=a.label;return(0,h.jsx)(f.z,{color:"brand",icon:void 0!==c&&c?(0,h.jsx)(d.I,{}):(0,h.jsx)(e.m,{}),type:"button",onClick:i,label:j||g.Children.toArray(b)[0]})};b.Z=i},345:function(a,b,c){"use strict";var d=c(7812),e=c(9499),f=c(975),g=c(211),h=c(846),i=c(9019),j=c(4689),k=c(9459),l=c(4923),m=c(8769),n=c(5709),o=c(7294),p=c(585),q=c(7403),r=c(6018),s=c(5893);function t(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function u(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?t(Object(c),!0).forEach(function(b){(0,e.Z)(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):t(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var v={id:0,name:"(no parent)"},w=function(a){var b=a.update,c=a.id,e=a.parent_id,t=(0,o.useContext)(p.Z),w=t.base.table("task_types"),x=(0,o.useState)({valid:!1}),y=x[0],z=x[1],A=(0,o.useState)(w.createData({parent_id:void 0===e?null:e,unit:"seconds"})),B=A[0],C=A[1],D=(0,o.useState)([]),E=D[0],F=D[1];(0,o.useEffect)(function(){c&&t.getTaskType(c).then(function(a){return a?(console.log("record is ",a),C(t.base.table("task_types").createData(u(u({},a.data),{},{unit:"seconds"})))):b(!1)});var a=t.base.stream({tableName:"task_types"},function(a){F(a.map(function(a){return a.data}))});return t.pollTaskTypes(),function(){a.unsubscribe()}},[t,c]);var G=(0,o.useMemo)(function(){return[v].concat((0,d.Z)(E)).filter(function(a){return!!a})},[E]);return G&&B?(0,s.jsxs)(f.x,{pad:"large",fill:!0,overflow:"scroll",children:[(0,s.jsxs)(g.X,{level:2,children:[c?"Edit Task Type":"Create a new TaskType",(0,s.jsx)("div",{style:{float:"right"},children:(0,s.jsx)(h.z,{plain:!0,icon:(0,s.jsx)(n.x,{}),onClick:function(){return b(!1)}})})]}),(0,s.jsxs)(i.l,{style:{minWidth:"80vw",minHeight:"80vh"},value:B,onValidate:z,onChange:C,validate:"change",onSubmit:function(a){var d=a.value,e=d.interval,f=d.unit;switch(e=Number.parseInt(d.interval,10),f){case"minutes":e*=60;break;case"hours":e*=3600}delete d.unit,t.saveTaskType(u(u({},d),{},{interval:e}),c).then(function(){return b(!0)})},children:[(0,s.jsx)(j.W,{validate:function(a){return!!(!c&&a&&t.hasTaskType(a))&&{property:"name",message:"Name must be unique.",status:"error"}},name:"name",htmlFor:"name-input-id",label:"Name",children:(0,s.jsx)(k.o,{id:"name-input-id",name:"name"})}),G.length>1?(0,s.jsx)(j.W,{label:"Parent",name:"parent_id",htmlFor:"parent-id-input",children:(0,s.jsx)(l.P,{id:"parent-id-input",name:"parent_id",labelKey:"name",value:B.parent_id||0,valueKey:{key:"id",reduce:!0},onChange:function(a){var b=a.value;C(u(u({},B),{},{parent_id:b}))},options:G,children:function(a,b,c,d){var e=d.selected;return(0,s.jsx)(q.Z,{selected:e,label:a.name})}})}):"",(0,s.jsxs)(f.x,{direction:"row",fill:"horizontal",gap:"medium",align:"stretch",children:[(0,s.jsx)(f.x,{width:"50%",children:(0,s.jsx)(j.W,{name:"interval",htmlFor:"interval-input-id",label:"Interval",children:(0,s.jsx)(m.K,{type:"number",id:"interval-input-id",name:"interval"})})}),(0,s.jsx)(f.x,{width:"50%",children:(0,s.jsx)(j.W,{name:"unit",htmlFor:"interval-units-input-id",label:"Unit",children:(0,s.jsx)(l.P,{defaultValue:"seconds",name:"unit",options:["seconds","minutes","hours"],id:"interval-units-input-id"})})})]}),(0,s.jsx)(j.W,{name:"notes",htmlFor:"notes-input-id",label:"Notes",children:(0,s.jsx)(m.K,{id:"notes-input-id",name:"notes"})}),(0,s.jsx)(f.x,{direction:"row",gap:"medium",children:(0,s.jsx)(r.Z,{id:c,valid:y.valid})})]})]}):""};b.Z=w},7403:function(a,b,c){"use strict";var d=c(975),e=c(9517);c(7294);var f=c(5893),g=function(a){var b=a.selected,c=a.label;return(0,f.jsx)(d.x,{pad:"2px",children:(0,f.jsx)(e.x,{weight:b?"bold":"normal",children:c})})};b.Z=g},6018:function(a,b,c){"use strict";var d=c(6074),e=c(5591),f=c(846),g=c(5893),h=function(a){var b=a.id,c=a.valid,h=a.saving;return(0,g.jsx)(f.z,{disabled:h||!c,type:"submit",icon:b?(0,g.jsx)(d.v,{}):(0,g.jsx)(e.m,{}),primary:!0,label:"Submit"})};b.Z=h},4432:function(a,b,c){"use strict";var d=c(975),e=c(211),f=c(3512),g=c(1664),h=c.n(g),i=c(5165),j=c(5893),k=function(a){var b=a.label,c=a.level,g=a.children,k=a.onCreate,l=a.createId,m=a.createLabel;return(0,j.jsxs)(d.x,{justify:"between",align:"center",direction:"row",fill:"horizontal",gap:"small",children:[(0,j.jsx)(h(),{href:"/",children:(0,j.jsx)(f.S,{})}),(0,j.jsx)(e.X,{level:void 0===c?1:c,children:b}),(0,j.jsx)(d.x,{direction:"row-reverse",fill:"horizontal",children:k?(0,j.jsx)(i.Z,{onClick:k,label:void 0===m?"":m,id:l}):g})]})};b.Z=k},6862:function(a,b,c){"use strict";c.r(b);var d=c(7294),e=c(9517),f=c(975),g=c(5009),h=c(1163),i=c(345),j=c(5165),k=c(585),l=c(4432),m=c(2203),n=c(5893),o=function(){console.log("--- taskTypes index");var a=(0,d.useState)(null),b=a[0],c=a[1],o=(0,d.useState)(!1),p=o[0],q=o[1],r=(0,h.useRouter)(),s=(0,d.useContext)(k.Z);return(0,d.useEffect)(function(){var a=s.base.stream({tableName:"task_types"},function(a){c(a.map(function(a){return a.data}))});return s.pollTaskTypes(),function(){a.unsubscribe()}},[s]),console.log("--- task types: ",b),(0,n.jsxs)(f.x,{pad:"large",children:[(0,n.jsx)(l.Z,{label:"Task Types",createLabel:"Create Task Type",onCreate:function(){return q(!0)}}),(0,n.jsx)(f.x,{align:"start",children:(0,n.jsx)(m.Z,{data:b,cols:[{property:"id",primary:!0,header:"ID",sortable:!0,size:"12rem",render:function(a){var b=a.id;return(0,n.jsx)(e.x,{truncate:!0,children:b})}},{property:"name",sortable:!0,header:"Name"},{property:"parent_id",header:"Parent",size:"12rem",sortable:!0,render:function(a){var c=a.parent_id;return(0,n.jsx)(e.x,{truncate:!0,children:function(a){if(!a)return"";var c=b.find(function(b){return b.id===a});return c?c.name:""}(c)||"--"})}},{property:"order",header:"Order",size:"6rem",render:function(a){var b=a.order;return(0,n.jsx)(e.x,{truncate:!0,children:Number.isNaN(b)?"--":b})}},{property:"children",key:"child-key-1",header:"Children",render:function(a){var b=s.ttChildrenFor(a.id);return(0,n.jsx)(e.x,{style:{whiteSpace:"nowrap"},wordBreak:"keep-all",children:b.length||""})}},{property:"interval",header:"Interval",sortable:!0},{property:"controls",header:"",key:"child-key-2",render:function(a){return(0,n.jsx)(f.x,{direction:"row-reverse",align:"start",children:(0,n.jsx)(j.Z,{id:a.id,onClick:function(){return r.push("taskTypes/edit/".concat(a.id))}})})}}]})}),p&&(0,n.jsx)(g.m,{children:(0,n.jsx)(i.Z,{update:function(){q(!1)}})})]})};b.default=o},8038:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/taskTypes",function(){return c(6862)}])},1163:function(a,b,c){a.exports=c(9898)},7812:function(a,b,c){"use strict";c.d(b,{Z:function(){return f}});var d=c(2587),e=c(2937);function f(a){return function(a){if(Array.isArray(a))return(0,d.Z)(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||(0,e.Z)(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},function(a){a.O(0,[517,389,762,652,783,774,888,179],function(){var b;return a(a.s=8038)}),_N_E=a.O()}])